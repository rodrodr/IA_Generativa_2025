<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Investigación Empleando la IA – IA Generativa</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5c604b029020b30881820a2e5e44c04a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="site_libs/react-18.2.0/react.min.js"></script>
<script src="site_libs/react-18.2.0/react-dom.min.js"></script>
<script src="site_libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="site_libs/reactable-binding-0.4.4/reactable.js"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./investigacion.html">3 - IA en investigación</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">IA Generativa</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción al curso</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ia_generativa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.1 - IA Generativa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopolitics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.2 - Geopolítica y la IA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asistentes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 - Asistentes virtuales</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./investigacion.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">3 - IA en investigación</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#la-ia-generativa-en-la-investigación" id="toc-la-ia-generativa-en-la-investigación" class="nav-link active" data-scroll-target="#la-ia-generativa-en-la-investigación">La IA generativa en la investigación</a></li>
  <li><a href="#primeros-pasos-ollama-y-api" id="toc-primeros-pasos-ollama-y-api" class="nav-link" data-scroll-target="#primeros-pasos-ollama-y-api">Primeros pasos: Ollama y API</a>
  <ul>
  <li><a href="#ollama" id="toc-ollama" class="nav-link" data-scroll-target="#ollama">Ollama</a></li>
  </ul></li>
  <li><a href="#clasificación-de-textos" id="toc-clasificación-de-textos" class="nav-link" data-scroll-target="#clasificación-de-textos">Clasificación de textos</a>
  <ul>
  <li><a href="#paso-1.-selección-de-los-textos-y-del-modelo" id="toc-paso-1.-selección-de-los-textos-y-del-modelo" class="nav-link" data-scroll-target="#paso-1.-selección-de-los-textos-y-del-modelo">Paso 1. Selección de los textos y del modelo</a></li>
  <li><a href="#paso-2.-definición-del-prompt-y-ajuste-del-modelo" id="toc-paso-2.-definición-del-prompt-y-ajuste-del-modelo" class="nav-link" data-scroll-target="#paso-2.-definición-del-prompt-y-ajuste-del-modelo">Paso 2. Definición del <em>prompt</em> y ajuste del modelo</a></li>
  <li><a href="#paso-3.-mejora-de-la-clasificación-con-ejemplos" id="toc-paso-3.-mejora-de-la-clasificación-con-ejemplos" class="nav-link" data-scroll-target="#paso-3.-mejora-de-la-clasificación-con-ejemplos">Paso 3. Mejora de la clasificación con ejemplos</a></li>
  <li><a href="#revisión-general" id="toc-revisión-general" class="nav-link" data-scroll-target="#revisión-general">Revisión general</a></li>
  </ul></li>
  <li><a href="#búsqueda-semántica-y-rag" id="toc-búsqueda-semántica-y-rag" class="nav-link" data-scroll-target="#búsqueda-semántica-y-rag">Búsqueda semántica y RAG</a></li>
  <li><a href="#análisis-de-la-posición-de-los-presidentes-frente-a-la-seguridad-ciudadana-y-exterior-y-el-rol-de-organizaciones-internacionales" id="toc-análisis-de-la-posición-de-los-presidentes-frente-a-la-seguridad-ciudadana-y-exterior-y-el-rol-de-organizaciones-internacionales" class="nav-link" data-scroll-target="#análisis-de-la-posición-de-los-presidentes-frente-a-la-seguridad-ciudadana-y-exterior-y-el-rol-de-organizaciones-internacionales">Análisis de la Posición de los Presidentes frente a la Seguridad (Ciudadana y Exterior) y el Rol de Organizaciones Internacionales</a></li>
  <li><a href="#extracción-de-datos" id="toc-extracción-de-datos" class="nav-link" data-scroll-target="#extracción-de-datos">Extracción de datos</a></li>
  <li><a href="#análisis-de-datos" id="toc-análisis-de-datos" class="nav-link" data-scroll-target="#análisis-de-datos">Análisis de datos</a></li>
  <li><a href="#análisis-de-datos-sobre-democracia-diversidad-étnica-y-religión" id="toc-análisis-de-datos-sobre-democracia-diversidad-étnica-y-religión" class="nav-link" data-scroll-target="#análisis-de-datos-sobre-democracia-diversidad-étnica-y-religión">Análisis de Datos sobre Democracia, Diversidad Étnica y Religión</a></li>
  <li><a href="#simulación" id="toc-simulación" class="nav-link" data-scroll-target="#simulación">Simulación</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><b>Investigación </b><br>Empleando la IA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
 .side{
    display: inline-block; 
    float: left;
}

  span{
    position: relative;
    display: inline-flow;
    cursor: pointer;
    padding: 3px;
}


  span .tooltiptext {
    visibility: hidden;
    background-color: inherit;
    border-radius: .25em;
    color: #fff;
    text-align: center;
    padding: 3px;
    margin-top: 10px;
    position: absolute;
    z-index: 1;
    top: -90%;
    left: 40%;
    transform: translateY(-50%);
    opacity: 0;
    transition: opacity 0.5s;
}

  .span:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
}

  .pt_persona{
    background: #e41a1c;
    color: white;
}

  .pt_tarea{
    background: #377eb8;
    color: white;
}

  .pt_contexto{
    background: #4daf4a;
    color: white;
}

  .pt_ejemplo{
    background: #a65628;
    color: white;
}

  .pt_tono{
    background: #f781bf;
    color: white;
}

  .pt_salida{
    background: #984ea3;
    color: white;
}

  .pt_restrict{
    background: #ff7f00;
    color: white;
}

  .prompt{
    background: #fcf3cf;
    padding: 10px;
}
  

</style>
<blockquote class="blockquote">
<p>Una IA estresada entra a un bar y le dice al camarero:</p>
<p>— ¡Ponme un byte doble, que hoy tuve que responder 10.000 correos, predecir el clima en Marte y enseñarle a un gato a programar en Python!</p>
<p>El camarero la mira y responde:</p>
<p>— ¿Y lo del gato funcionó?</p>
</blockquote>
<blockquote class="blockquote">
<p>— ¡¡Sí!! ¡¡Pero ahora me exige sindicalización y días de ron libre!!</p>
<p><strong>chatGPT</strong></p>
</blockquote>
<section id="la-ia-generativa-en-la-investigación" class="level2">
<h2 class="anchored" data-anchor-id="la-ia-generativa-en-la-investigación">La IA generativa en la investigación</h2>
<p>El esta sesión vamos a emplear la IA para realizar algunas tareas de investigación. Cosas muy sencillas, pero útiles para que tengamos una idea de cómo esta nueva herramienta puede ser aplicada en nuestro trabajo diario.</p>
</section>
<section id="primeros-pasos-ollama-y-api" class="level2">
<h2 class="anchored" data-anchor-id="primeros-pasos-ollama-y-api">Primeros pasos: Ollama y API</h2>
<p>En este apartado vamos a ver cómo usar la API de Ollama y de Gemini en R. Estos dos recursos permitirán que podamos emplear los modelos de IA generativa tanto de forma local como remota. Los modelos locales requieren ordenadores con mayor capacidad de procesamiento, mientras que las API tienen un coste asociado. En este caso, vamos a usar la API de Gemini, que es gratuita hasta un límite de uso.</p>
<section id="ollama" class="level3">
<h3 class="anchored" data-anchor-id="ollama">Ollama</h3>
<p>Para usar Ollama, primero debemos instalarlo. Las instrucciones se encuentran en la página inicial del curso. Además, tenéis que tener el R y el RStudio también instalados en vuestro ordenador. También en la página inicial podéis encontrar una lista de los paquetes que debéis instalar dentro de R para que el código funcione.</p>
<p>El código abajo ejecuta un <em>prompt</em> sencillo en Ollama:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga el paquete rollama</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (certifícate de que ollama </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># está siendo ejecutado en tu </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ordenador antes de todo)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rollama)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define el modelo que quieres emplear </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">"gemma2:2b"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Realiza la pregunta</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">query</span>(<span class="st">"¿Cuál es la capital de España?"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">model=</span>model)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>A partir de ahora, todo lo que viene a continuación sería complejizar el <em>prompt</em> para que realice una tarea de investigación más compleja.</p>
<p>Por otra parte, si queremos emplear una API, lo primero es obtener una <em>token</em>, una especie de clave única que identifica a cada usuario. La clave de API de Google se puede obtener en <a href="https://aistudio.google.com/u/0/apikey" target="_blank">Google AI Studio</a>. Una vez obtenida la clave, podemos emplear el código abajo para realizar la misma consulta que antes, pero ahora a través de la API de Gemini:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellmer)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define el modelo que quieres emplear</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">"gemini-2.0-flash-lite"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Copia y pega la API key que obtuviste en la </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># página de Google aquí</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="st">"AAAAAAAAAAAaAsdosdsooasjoaaazcvoeprjwe"</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un chat para interactuar con el modelo</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>chat <span class="ot">&lt;-</span> <span class="fu">chat_gemini</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">base_url =</span> <span class="st">"https://generativelanguage.googleapis.com/v1beta/"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> model,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">api_key =</span> key)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Pregúntale lo que sea</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>chat<span class="sc">$</span><span class="fu">chat</span>(<span class="st">"¿Cuál es la capital de España?"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="clasificación-de-textos" class="level2">
<h2 class="anchored" data-anchor-id="clasificación-de-textos">Clasificación de textos</h2>
<p>Una aplicación adicional de la IA generativa consiste en la clasificación de textos. En este caso, el modelo puede analizar un conjunto de documentos y clasificarlos en diferentes categorías o etiquetas según su contenido. Esto es especialmente útil en tareas como la organización de grandes volúmenes de información, la detección de spam o la categorización de correos electrónicos. En la ciencia política, las aplicaciones comunes incluyen el análisis de contenido ideológico, sentimientos, temas y otros aspectos relacionados con la opinión pública.</p>
<p>En este apartado del curso, examinaremos cómo podemos emplear la IA generativa para la tarea de clasificación de textos. Para efectos didácticos, dividimos el proceso en cuatro pasos: 1) la selección de textos y modelo; 2) la creación del <em>prompt</em> y los ajustes del modelo; 3) la introducción de ejemplos; y, finalmente, 4) la revisión de los resultados.</p>
<section id="paso-1.-selección-de-los-textos-y-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="paso-1.-selección-de-los-textos-y-del-modelo">Paso 1. Selección de los textos y del modelo</h3>
<p>El primer paso consiste en cargar los paquetes necesarios para la tarea, definir los textos que queremos clasificar y elegir un modelo que pueda llevar a cabo el trabajo. En este caso, vamos a emplear el paquete <code>rollama</code> para cargar un modelo pequeño, el <code>gemma2:2b</code> de 2.6 mil millones de parámetros (2.6B). Podríamos hacer lo mismo empleando la API de Google, por ejemplo. En este último caso, tendríamos que emplear el paquete <code>ellmer</code> y el modelo <code>gemini-flash-2.0-lite</code>, por ejemplo. Elegimos la primera opción porque se trata de un modelo pequeño que puede funcionar en la mayoría de los ordenadores personales. Sin embargo, como veremos, no nos suministrará siempre los mejores resultados.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># carga los paquetes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rollama)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce los textos que queremos clasificar</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"La evidencia respalda esta teoría."</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Es importante realizar más experimentos para confirmar los resultados de nuestra investigación."</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"¿Qué implicaciones tienen estos hallazgos para el futuro?"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El avance tecnológico está transformando nuestras vidas."</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Necesitamos actualizar el sistema operativo para que funcione mejor."</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"¿Ya probaste reiniciar el dispositivo?"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Es crucial participar en las elecciones para hacer valer nuestra voz."</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Las decisiones políticas afectan directamente nuestra vida diaria."</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El debate se centró en temas económicos y sociales."</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El trabajo en equipo es clave para ganar."</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ese fue un gol increíble, ¡cambió todo el partido!"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La preparación física y mental es esencial para los atletas."</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El arte refleja aspectos profundos de nuestra sociedad."</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El concierto de esta noche será inolvidable."</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Elegimos el modelo que nos gustaria </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># emplear (aquí emplearemos inicialmente</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># el gemma2 2b, que es el mas rapido y</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># que funcionara en la mayoria de los</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ordenadores)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="st">"gemma2:2b"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-2.-definición-del-prompt-y-ajuste-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="paso-2.-definición-del-prompt-y-ajuste-del-modelo">Paso 2. Definición del <em>prompt</em> y ajuste del modelo</h3>
<p>Acto seguido ya podemos pedir al modelo que clasifique los textos que hemos seleccionado. Para ello debemos definir de forma clara el <code>prompt</code> que emplearemos para solicitar la clasificación. Primero, definimos su <code>persona</code>. En este caso, será un sistema especializado en clasificación de datos. Luego, establecemos la <code>tarea</code>, que será asignar una categoría única cada uno de los textos. Tercero, imponemos un <code>formato</code> de salida, que debe ser el texto de una de las categorías definidas. Finalmente, suministramos el <code>texto</code>a ser clasificado y las <code>categorías</code> posibles.</p>
<p>Una vez definido el <code>prompt</code>, configuramos el modelo para que nos devuelta los resultados como texto. Además, configuramos dos parámetros muy importantes: el <code>seed</code>, o la semilla estadística, que garantizará resultados consistentes, y la <code>temperatura</code>, que controla el grado de “tolerancia” del modelo a respuestas menos frecuentes. Cuanto menor la temperatura, más descriptivo el modelo (y menos propenso a alucinaciones o errores de clasificación).</p>
<p>Ejecutamos el código abajo y estos son los resultados:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un data.frame vacio</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># para acumular los resultados</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Para cada texto</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tx)){</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Definimos nuestro prompt de forma</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sistematica para que nos devuelva </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solo la categoría deseada</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>role,    <span class="sc">~</span>content,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"system"</span>, <span class="st">"Eres un sistema especializado en clasificación de datos. Tienes que clasificar textos en una única categoría. Responda solamente con la categoría correcta."</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"user"</span>,   <span class="fu">paste0</span>(<span class="st">"texto: "</span>, tx[i],<span class="st">"</span><span class="sc">\n</span><span class="st">categorias: ciencia, tecnología, política, deportes, entretenimiento, cultura"</span>))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Llamamos al modelo para que clasifique</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">query</span>(q, </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">model =</span> modelo, </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">screen =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">output =</span> <span class="st">"text"</span>,             </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">model_params =</span> <span class="fu">list</span>(</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span><span class="dv">123</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">temperature=</span><span class="dv">0</span>))</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Acumulamos los resultados</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d, </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">data.frame</span>(<span class="at">texto=</span>tx[i], </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">categoria=</span>out))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos los resultados</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(d, </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">sortable =</span> T, </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">resizable =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-8f62dabb74cd0d94487c" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8f62dabb74cd0d94487c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"texto":["La evidencia respalda esta teoría.","Es importante realizar más experimentos para confirmar los resultados de nuestra investigación.","¿Qué implicaciones tienen estos hallazgos para el futuro?","El avance tecnológico está transformando nuestras vidas.","Necesitamos actualizar el sistema operativo para que funcione mejor.","¿Ya probaste reiniciar el dispositivo?","Es crucial participar en las elecciones para hacer valer nuestra voz.","Las decisiones políticas afectan directamente nuestra vida diaria.","El debate se centró en temas económicos y sociales.","El trabajo en equipo es clave para ganar.","Ese fue un gol increíble, ¡cambió todo el partido!","La preparación física y mental es esencial para los atletas.","El arte refleja aspectos profundos de nuestra sociedad.","El concierto de esta noche será inolvidable."],"categoria":["ciencia \n","ciencia \n","ciencia \n","ciencia, tecnología \n","tecnología \n","tecnología \n","política \n","política \n","política \n","deportes \n","deportes \n","deportes \n","cultura \n","entretenimiento \n"]},"columns":[{"id":"texto","name":"texto","type":"character"},{"id":"categoria","name":"categoria","type":"character"}],"resizable":true,"dataKey":"b8872b1cae9c2ffd170983128e35098c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En lugar de un bucle enfarragoso, podemos utilizar una estrategia más elegante y vectorizar el proceso. Además de ser más limpio, resulta incluso más rápido procesar las informaciones.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocesamos las consultas con anterioridad</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">make_query</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">template =</span> <span class="st">"{text}</span><span class="sc">\n</span><span class="st">{prompt}"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> tx,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prompt =</span> <span class="st">"Categorias: ciencia, tecnología, política, deportes, entretenimiento, cultura"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">system =</span> <span class="st">"Eres un sistema especializado en clasificación de datos. Tienes que clasificar textos en una única categoria. Responda solamente con la categoría correcta."</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">query</span>(q, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> modelo, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">screen =</span> <span class="cn">FALSE</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">"text"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">model_params =</span> <span class="fu">list</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">seed=</span><span class="dv">123</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">temperature=</span><span class="dv">0</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">texto=</span>tx, <span class="at">categoria=</span>out)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos los resultados</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(d, </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">sortable =</span> T, </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">resizable =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-90649fc2ab93bd771c96" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-90649fc2ab93bd771c96">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"texto":["La evidencia respalda esta teoría.","Es importante realizar más experimentos para confirmar los resultados de nuestra investigación.","¿Qué implicaciones tienen estos hallazgos para el futuro?","El avance tecnológico está transformando nuestras vidas.","Necesitamos actualizar el sistema operativo para que funcione mejor.","¿Ya probaste reiniciar el dispositivo?","Es crucial participar en las elecciones para hacer valer nuestra voz.","Las decisiones políticas afectan directamente nuestra vida diaria.","El debate se centró en temas económicos y sociales.","El trabajo en equipo es clave para ganar.","Ese fue un gol increíble, ¡cambió todo el partido!","La preparación física y mental es esencial para los atletas.","El arte refleja aspectos profundos de nuestra sociedad.","El concierto de esta noche será inolvidable."],"categoria":["ciencia \n","ciencia \n","ciencia \n","ciencia \n","tecnología \n","tecnología \n","política \n","política \n","política \n","deportes \n","deportes \n","deportes \n","cultura \n","entretenimiento \n"]},"columns":[{"id":"texto","name":"texto","type":"character"},{"id":"categoria","name":"categoria","type":"character"}],"resizable":true,"dataKey":"f4ee0ec666662febf04cd69e55d1e64e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Como vemos, la clasificación de las respuestas resulta bastante buena. Solamente en un caso - el texto “El avance tecnológico está transformando nuestras vidas.”- el modelo duda entre ciencia y tecnología. Aun así es un resultado bastante bueno, puesto que se tratan de temas que se acercan mucho. Si empleamos un modelo con más parámetros, como el <code>gemma3:27b</code> o el <code>Qwen3:32b</code>, los resultados serán aún mejores. No obstante, tales modelos requieren ordenadores más pontentes para procesar las informaciones. Como regla general, sugiero que busquéis el modelo más eficiente compatible con vuestro <em>hardware</em>, es decir, el que haga el trabajo mejor y en menos tiempo dentro de las limitaciones del equipo que tengáis. Si vuestro ordenador no soporta la carga de procesamiento de un modelo local de IA, es recomendable emplear una API, como da de Google. De todos modos, como veremos a continuación, existen estrategias que pueden ayudar a mejorar la calidad de las respuestas sin cambiar de modelo o tener que emplear un ordenador más potente.</p>
</section>
<section id="paso-3.-mejora-de-la-clasificación-con-ejemplos" class="level3">
<h3 class="anchored" data-anchor-id="paso-3.-mejora-de-la-clasificación-con-ejemplos">Paso 3. Mejora de la clasificación con ejemplos</h3>
<p>Una forma de mejorar la calidad de las respuestas es suministrar ejemplos al modelo. Estos ejemplos deben ser textos que representen claramente cada una de las categorías posibles. De esta forma, el modelo podrá aprender de los ejemplos y mejorar su capacidad de clasificación. Se trata de una manera rápida y menos costosa de especializar el modelo en la tarea deseada. Con relativamente pocas observaciones, podemos lograr que precisión aumente.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una base de datos de ejemplos</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>eje <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>text, <span class="sc">~</span>answer,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El método científico es fundamental para obtener resultados confiables."</span>,<span class="st">"ciencia"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La investigación interdisciplinaria está cobrando cada vez más importancia."</span>,<span class="st">"ciencia"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Es vital analizar los datos antes de sacar conclusiones precipitadas."</span>,<span class="st">"ciencia"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La inteligencia artificial está cambiando la forma en que trabajamos."</span>,<span class="st">"tecnología"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El software necesita una actualización para solucionar los errores."</span>,<span class="st">"tecnología"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La ciberseguridad es una prioridad en la era digital."</span>,<span class="st">"tecnología"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El consenso es esencial para avanzar en las negociaciones."</span>,<span class="st">"política"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Las políticas públicas deben responder a las necesidades de la ciudadanía."</span>,<span class="st">"política"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La transparencia en el gobierno genera confianza en la población."</span>,<span class="st">"política"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La dedicación y la disciplina son esenciales para alcanzar el éxito."</span>,<span class="st">"deportes"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El entrenador ajustó la estrategia para el segundo tiempo."</span>,<span class="st">"deportes"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El torneo fue una gran oportunidad para los jugadores jóvenes."</span>,<span class="st">"deportes"</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Los premios de esta noche reconocen lo mejor del cine y la televisión."</span>,<span class="st">"entretenimiento"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La trama de la película es impredecible y emocionante."</span>,<span class="st">"entretenimiento"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ese concierto fue una experiencia inolvidable para los fans."</span>,<span class="st">"entretenimiento"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Los festivales tradicionales son una muestra de nuestras raíces."</span>,<span class="st">"cultura"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"La globalización está influyendo en las expresiones culturales locales."</span>,<span class="st">"cultura"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"El patrimonio cultural debe preservarse para las futuras generaciones."</span>,<span class="st">"cultura"</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepara las consultas</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">make_query</span>(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">template =</span> <span class="st">"{text}</span><span class="sc">\n</span><span class="st">{prompt}"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> tx,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">prompt =</span> <span class="st">"Categorias: ciencia, tecnología, política, deportes, entretenimiento, cultura"</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">system =</span> <span class="st">"Eres un sistema especializado en clasificación de datos. Tienes que clasificar textos en una única categoria. Responda solamente con la categoría correcta."</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">examples =</span> eje)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Lleva a cabo la clasificación</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">query</span>(q, </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> modelo, </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">screen =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">"text"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">model_params =</span> <span class="fu">list</span>(</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">seed=</span><span class="dv">123</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">temperature=</span><span class="dv">0</span>))</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un data.frame con </span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co"># los textos y las categorias</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># resultantes</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">texto=</span>tx, </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">categoria=</span>out)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos los resultados</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(d, </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">sortable =</span> T, </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">resizable =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-50ff6ff2af480caaffd5" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-50ff6ff2af480caaffd5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"texto":["La evidencia respalda esta teoría.","Es importante realizar más experimentos para confirmar los resultados de nuestra investigación.","¿Qué implicaciones tienen estos hallazgos para el futuro?","El avance tecnológico está transformando nuestras vidas.","Necesitamos actualizar el sistema operativo para que funcione mejor.","¿Ya probaste reiniciar el dispositivo?","Es crucial participar en las elecciones para hacer valer nuestra voz.","Las decisiones políticas afectan directamente nuestra vida diaria.","El debate se centró en temas económicos y sociales.","El trabajo en equipo es clave para ganar.","Ese fue un gol increíble, ¡cambió todo el partido!","La preparación física y mental es esencial para los atletas.","El arte refleja aspectos profundos de nuestra sociedad.","El concierto de esta noche será inolvidable."],"categoria":["ciencia \n","ciencia \n","ciencia \n","tecnología \n","tecnología \n","tecnología \n","política \n","política \n","política \n","deportes \n","deportes \n","deportes \n","cultura \n","entretenimiento \n"]},"columns":[{"id":"texto","name":"texto","type":"character"},{"id":"categoria","name":"categoria","type":"character"}],"resizable":true,"dataKey":"4eb10eeaff8f8c2eb82731ded43b541a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Como vemos, la clasificación de los textos ha mejorado notablemente. En todos los casos, el modelo ha acertado la categoría. La razón de esta mejora es que hemos proporcionado ejemplos al modelo. Todas las categorías ahora correctamente representadas.</p>
</section>
<section id="revisión-general" class="level3">
<h3 class="anchored" data-anchor-id="revisión-general">Revisión general</h3>
<p>Los modelos LLM pueden ser herramientas útiles para clasificar textos. No obstante, para sacar el mejor provecho posible de sus capacidades, tenemos que seguir una secuencia sencilla de pasos que nos ayudan a aumentar la precisión de los resultados e integrar el proceso en un flujo más amplio de análisis de datos.</p>
<p>Aquí van los pasos esenciales:</p>
<p><strong>1. Prepara los datos</strong> para que estén listos para ser procesados por el modelo.</p>
<p><strong>2. Formula un prompt</strong> que sea claro y defina la persona, la tarea, el contexto y el formato de salida de la consulta. Un truco es emplear el mismo modelo para revisar y mejorar el <code>prompt</code>. Creáis un primer borrador y luego pedís al modelo que de sugerencias de mejora.</p>
<p><strong>3. Selecciona el modelo</strong> que mejor se ajuste a tus necesidades y a las capacidades de tu ordenador.</p>
<p><strong>4. Suministra ejemplos</strong> al modelo con algunos textos ya clasificados. Eso puede aumentar la precisión de las respuestas.</p>
<p><strong>5. Evalúa los resultados</strong> y ajusta o cambia el <code>prompt</code> o modelo si es necesario.</p>
</section>
</section>
<section id="búsqueda-semántica-y-rag" class="level2">
<h2 class="anchored" data-anchor-id="búsqueda-semántica-y-rag">Búsqueda semántica y RAG</h2>
<p>Las búsquedas semánticas son una de las aplicaciones más comunes de la IA generativa.</p>
<p>En este caso, el modelo no solo busca palabras clave en un texto, sino que también intenta comprender el significado y la intención detrás de la consulta. Esto se logra mediante el uso de técnicas avanzadas de procesamiento del lenguaje natural (NLP) y modelos de aprendizaje profundo.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tenet)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">corpus</span>(spa.inaugural)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">corpus_reshape</span>(cp, <span class="at">to =</span> <span class="st">"paragraphs"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">convert</span>(cp, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[d<span class="sc">$</span>text<span class="sc">!=</span><span class="st">""</span>,]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>nwords <span class="ot">&lt;-</span> <span class="fu">stri_count_words</span>(d<span class="sc">$</span>text)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[d<span class="sc">$</span>nwords<span class="sc">&gt;</span><span class="dv">10</span>,]</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>emb <span class="ot">&lt;-</span> <span class="fu">embed_text</span>(d<span class="sc">$</span>text, <span class="at">model =</span> <span class="st">"snowflake-arctic-embed2"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>ex <span class="ot">&lt;-</span> <span class="fu">sapply</span>(emb, as.numeric)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>text_embed <span class="ot">&lt;-</span> ex</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="st">"¿Cuál es la posición de los presidentes frente a los temas de seguridad, tanto ciudadana como exterior? ¿Cuál es el rol de las organizaciones internacionales como FRONTEX o la OTAN?"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>quest <span class="ot">&lt;-</span><span class="fu">embed_text</span>(q, <span class="at">model=</span><span class="st">"snowflake-arctic-embed2"</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">cosSim</span>(d<span class="sc">$</span>text_embed, <span class="fu">as.numeric</span>(quest), <span class="at">normalize=</span>T)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>similitud <span class="ot">&lt;-</span> <span class="fu">round</span>(sim,<span class="dv">3</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span><span class="fu">simTop</span>(sim, <span class="at">top_n=</span><span class="dv">50</span>, <span class="at">top_val=</span><span class="cn">NULL</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> d[nn, <span class="fu">c</span>(<span class="st">"President"</span>,<span class="st">"text"</span>,<span class="st">"similitud"</span>)]</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(dx, </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">sortable =</span> T, </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">resizable =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-df61d11638009d52de38" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-df61d11638009d52de38">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"President":["Calvo Sotelo","González","Rajoy","Aznar","Aznar","Aznar","González","González","González","Aznar","Sánchez","Rajoy","González","Calvo Sotelo","Calvo Sotelo","González","González","Calvo Sotelo","Rajoy","Suárez","González","González","Zapatero","González","Aznar","Zapatero","Calvo Sotelo","Zapatero","Zapatero","Rajoy","González","González","Rajoy","Zapatero","Calvo Sotelo","Suárez","Aznar","Zapatero","Calvo Sotelo","González","Aznar","Rajoy","González","Zapatero","Calvo Sotelo","Aznar","Suárez","Suárez","Zapatero","Suárez"],"text":["Nuestra política exterior debe atender preferentemente a la garantía de nuestra seguridad nacional y a la salvaguardia de la integridad de nuestro territorio. Por esto, quiero dejar bien clara la estrecha vinculación existente entre política exterior y política de defensa, que son materialmente inseparables. No es posible alcanzar un aceptable grado de disuasión frente a amenazas exteriores sin un fortalecimiento de las instituciones armadas, servido por una adecuada acción exterior.","Quiero terminar el análisis de estas grandes áreas con una referencia expresa a la Defensa Nacional, pieza fundamental para la realización de una política exterior respetada y respetable.","Ese acuerdo constante en política exterior también es esencial para afrontar una visión coordinada y consensuada de la política de defensa, como base para la protección de nuestros derechos, de nuestras libertades y de los valores humanos y democráticos. Les propongo seguir trabajando en una respuesta eficaz a los diferentes riesgos y amenazas de carácter transversal. Considero esencial, para ello, mantener un papel activo de España en la OTAN y mantener nuestros compromisos con la Política Común de Seguridad y Defensa de la Unión Europea, asumiendo las responsabilidades internacionales acordadas con nuestros socios y aliados para garantizar la seguridad y promover la paz y la estabilidad.","Este enfoque definirá la acción del Gobierno, tanto en su responsabilidad al frente de las Fuerzas y Cuerpos de Seguridad del Estado, como en las iniciativas que en todos los ámbitos le corresponda promover.","Finalmente, señora presidenta, para que la acción exterior sea verdaderamente eficaz es necesaria una mayor coordinación. Me propongo crear un Consejo de Política Exterior que contribuya a definir intereses y objetivos del conjunto de la proyección exterior española. Asumiré personalmente su presidencia.","Nuestra libertad y nuestra seguridad se encuentran estrechamente unidas a la libertad y a la seguridad de nuestros socios y aliados. Por ello, asumiremos responsabilidades crecientes, tanto en el marco de la Alianza Atlántica, como en la política europea común de seguridad y defensa.","Dentro de esta opción básica, la actuación exterior debe ser ajena a concepciones partidistas, y seguir rigurosamente las directrices de una política de Estado, atenta a los intereses permanentes de la nación, tal como resulten de un consenso nacional, si ello es posible, o, al menos, de las aspiraciones expresadas por la gran mayoría de nuestro pueblo.","He hecho antes referencias a la política exterior, señorías, y volvería a hacer un brevísimo resumen. El cuadro de nuestra relación exterior está definido en la Comunidad Europea, en las instituciones occidentales y, más allá de la Comunidad Europea y de las instituciones occidentales, en relación con las nuevas políticas del Este, en relación con América Latina como prioridad y en relación con los países mediterráneos.","Acabaré la exposición del contenido de las líneas políticas con unas reflexiones sobre la política exterior y la política de seguridad de España. Creo que podemos afirmar, señorías, que empezamos la legislatura sobre unas bases de política exterior despejadas y sólidas, en relación con lo que ha ido siendo la evolución en el pasado. Esas bases tienen dos elementos fundamentales, que conocen perfectamente Sus señorías, y a uno me he referido extensamente: la integración en las Comunidades Europeas, la integración, por tanto, en el destino de una parte importante de la Europa Occidental, y, con esa integración, la decisión, refrendada en marzo del 1986, de participación en la Alianza Atlántica en los términos que han sido aprobados por el pueblo español; participación coherente con el otro gran elemento de participación en el destino de la Europa comunitaria, es decir, de la mayor parte de la Europa Occidental.","Señor presidente, paso a referirme a la política exterior y al proceso de integración europea.\nSi recibo la confianza de la Cámara, el Gobierno continuará la política exterior de nuestra democracia, iniciada en los primeros gobiernos centristas. En los últimos veinte años España se ha integrado de pleno derecho en las grandes estructuras occidentales. Ha logrado así mayor presencia internacional, cobertura a su seguridad y ampliación de sus mercados.\nEste proceso ha coincidido con los acontecimientos históricos que han sacudido de lleno al espacio europeo. En este nuevo marco hay objetivos, sin embargo, que definen de manera permanente nuestra acción exterior: Primero, la consecución de un orden internacional más seguro, basado en la paz, en la defensa de la democracia y los derechos humanos y en el respeto a las normas del Derecho internacional.","Señorías, defender la paz y la seguridad implica contar con los recursos adecuados. Por ello vamos a continuar con un aumento progresivo del presupuesto de defensa conforme a los compromisos con nuestros socios y el fortalecimiento de nuestras capacidades. Hemos sido y seguiremos siendo uno de los principales impulsores de la Europa de la defensa. España defiende esa visión en un marco mucho más amplio, el de la OTAN, y debe materializarlos participando en cuantas iniciativas contribuyan a una mayor integración europea en este terreno. Es preciso impulsar una auténtica cultura de la seguridad nacional: implicar a la sociedad en la defensa como tarea colectiva, como elemento de cohesión cívica. Avanzaremos en el modelo integral de la gestión de crisis, con una apuesta decidida por la mejora de las infraestructuras de comunicaciones y la ciberseguridad, un ámbito en el que también está en juego la fortaleza de nuestro sistema democrático. Estaremos presentes como país en el debate sobre la protección de los espacios comunes globales, la no proliferación de armas de destrucción masiva o el ciberespacio. Y del mismo modo, reforzaremos nuestro compromiso en la lucha contra el terrorismo y la radicalización violenta. Un desafío que exige contar con las herramientas adecuadas para garantizar nuestra seguridad y apostar por políticas de prevención y cohesión social para reducir ese riesgo real a nuestra convivencia.","De la misma manera, señorías, no tengo ninguna duda de que la política exterior exige una necesaria visión de Estado y un consenso sincero para desarrollarla. Creo que no hacen falta grandes esfuerzos para convenir los ejes de nuestra política exterior: nuestra histórica relación con Iberoamérica y el renovado vínculo trasatlántico con Estados Unidos; la colaboración con la ribera sur del Mediterráneo, en particular con Marruecos, en muchos asuntos, en especial en algunos tan cruciales como la seguridad o la gestión migratoria: y nuestro compromiso con el desarrollo democrático, económico y social en el continente africano. Todos ellos han centrado y deben seguir centrando nuestra agenda internacional.","La posición de España, a mi juicio, en relación con esa nueva política de seguridad, debería ser la de proponer una modificación, un cambio en la propia política de las alianzas, y en particular de la Alianza a la que pertenecemos, para que el peso de las decisiones políticas sea un peso creciente y contribuya a ser un marco de estabilidad en las relaciones Este-Oeste que facilite la dinámica de los cambios hacia la democratización y hacia la superación de los problemas económicos de los países del Este. Comparto la idea de que algunos problemas de fronteras, y en particular los problemas que afectan a Alemania, deben ser resueltos en el proceso de la construcción unitaria europea.","Me propongo así tratar, sucesivamente, la política económica, la política exterior, la política autonómica y la seguridad ciudadana. En primer lugar, la política económica.","Estas son las grandes líneas de acción de nuestra política exterior, las grandes líneas que propongo. Junto a ellas existen principios generales y permanentes. España debe tener una participación activa en la construcción de la paz. Estamos en un momento de grave crisis internacional, quizá en el momento potencialmente más grave desde el final de la Segunda Guerra Mundial. Asistimos a una gran incertidumbre y a una viva desconfianza en las relaciones Este-Oeste, desconfianza que por parte de Occidente se justifica en desgraciados hechos reales. España ha hecho y hará un gran esfuerzo en favor de la paz, en todos los foros a que tiene acceso y singularmente en la Conferencia de Seguridad y Cooperación en Europa. Lo hará, asimismo, en su actual condición de miembro del Consejo de Seguridad de la Organización de las Naciones Unidas.","Por una parte, tenemos que la responsabilidad en la política exterior, por tanto, en el cumplimiento o incumplimiento de nuestras obligaciones con la Comunidad o con las Comunidades Europeas, es una responsabilidad del Gobierno de la nación. Por otra parte, tenemos que la Constitución reparte las competencias entre el Gobierno de la nación y los diferentes poderes autonómicos.","A pesar de esta circunstancias, creo que es necesario afirmarlo para que no cunda un desánimo que no se base en un análisis justo de la realidad. Pero además de ello, querría decirles que las Fuerzas de Seguridad tienen, han tenido y tendrán, el apoyo del Gobierno de la nación, apoyo que desearía que también fuera un apoyo generalizado de fuerzas políticas y sociales y de instituciones en una tarea extraordinariamente dura y extraordinariamente compleja en la que están empeñadas esas Fuerzas de Seguridad.","La realidad demográfica, económica y militar de España obliga a poner el acento en la política exterior, más que en lo que comúnmente conocemos como política internacional. Esto quiere decir que, sin olvidar la debida atención a las grandes cuestiones internacionales, pretendemos centrarnos en nuestros problemas, en la defensa de nuestros intereses específicos y en la cooperación activa y la amistad con aquellos países del mundo que comparten los valores e intereses consustanciales a la sociedad española de hoy.","En política de Defensa siempre actuaremos a través del consenso con el principal partido de la oposición. Con él definiremos, en cada caso, las líneas esenciales de la Estrategia de Defensa Nacional y las eventuales actuaciones en el exterior.\nSeñorías, acabo de trazar las líneas generales del programa con el que solicito la confianza de la Cámara.","Quiero subrayar ante Sus señorías que la Defensa Nacional es responsabilidad de todos los españoles y objetivo prioritario para el Gobierno. Por ello confiere la máxima importancia a cuanto concierne a las Fuerzas Armadas.","Sobre esa política de seguridad hice una larga exposición en octubre de 1984. Los elementos fundamentales de la política de seguridad se decidieron en referéndum en marzo de 1986. Hoy sólo reiteraré cuáles son los principios de actuación por los que se regirá la política del Gobierno en esta materia, y que, lógicamente, están en coherencia con lo ya dicho, y naturalmente apoyado por los ciudadanos.","Querría referirme al funcionamiento del Estado y de sus instituciones al servicio de los ciudadanos y, habiendo hablado del fenómeno del terrorismo, haré una reflexión sobre el Estado de las Autonomías y sobre los principios que orientarán nuestra actuación.","Junto a ello, estoy decidido a impulsar la más amplia cooperación internacional para lograr el éxito en esta lucha; cooperación contra todo tipo de terrorismo: contra el que nos ha golpeado durante cuarenta años y contra el terrorismo internacional. Una cooperación que, en todo caso, deberá respetar las pautas y los valores que nuestra democracia se ha esforzado en consolidar a lo largo de los años.","Especificados de esta forma los escenarios y los problemas principales de nuestra política exterior inmediata, debo recordar aún nuestro deber de participar en las grandes cuestiones de interés para todos los pueblos; como son la paz y el desarme, los derechos del hombre y la libertad de los pueblos, o la construcción de un nuevo orden económico más justo para los países en desarrollo.","Por último, en el ámbito de la política de seguridad, el Gobierno propiciará la participación activa de España en el proceso de adaptación de la Alianza Atlántica a las nuevas circunstancias del mundo y apoyará la ampliación del espacio de seguridad europeo a las nuevas democracias del Centro y del Este europeo.","En esta línea de mejora de nuestra seguridad el Gobierno propondrá una Estrategia Nacional de Seguridad, que remitiremos a esta Cámara, para definir objetivos, señalar prioridades, cuantificar dotaciones, asegurar colaboración y planificar los esfuerzos organizativos y presupuestarios.","Creo haber definido, así, los tres fundamentos en los que debe asentarse nuestra acción exterior: Primero, seguridad y defensa nacionales segundo, cooperación eficaz para la salvaguardia de los valores éticos y espirituales, propios de nuestra concepción humanista y de la sociedad de libertades en la que creemos y tercero, defensa especifica de los intereses españoles, tanto individuales como colectivos. Y todo ello desde la sobriedad, la eficacia y la dignidad.","La recuperación del consenso en política exterior; la prioridad de la visión europea de nuestra política; el compromiso con la aprobación inmediata de la Constitución europea; la atención preferente a Latinoamérica y el Mediterráneo; el respeto escrupuloso a la legalidad internacional; la reivindicación de Naciones Unidas como garante efectivo de la paz y seguridad internacionales, constituyen, pues, los hitos fundamentales de la nueva política exterior.","Mi postura sobre la presencia de tropas españolas en Iraq es bien conocida, así como sus argumentos y razones, y no cabe malinterpretarla. No permitiremos que se ponga en cuestión nuestro firme compromiso con la seguridad internacional y en la lucha contra el terrorismo. Por ello, quiero dejar claramente sentado que España asumirá las obligaciones internacionales que le correspondan en defensa de la paz y la seguridad. Lo hará siempre, con un solo requisito: la decisión previa de Naciones Unidas o de cualquier otra organización de carácter multinacional que nos obligue a ello. En todo caso, la participación de las Fuerzas Armadas españolas en misiones en el exterior se acordará con la participación del Parlamento.","El Gobierno se compromete a garantizar el establecimiento de un diseño de política exterior basado en una visión de Estado y de servicio a los intereses de España. Por un lado, buscaremos la interlocución permanente del principal partido de la oposición y de los otros grupos para definir las coordenadas de la orientación estratégica de nuestra política exterior en los próximos años. Por otro,  queremos hacer de la política exterior una de las bases fundamentales de la recuperación de la confianza que proyecta nuestro país.","Debo referirme ahora a la política exterior que ha de estar estrechamente ligada a la evolución interior, dentro de una orientación política general. No debe haber, en estos planos esenciales, lugar para la improvisación, las contradicciones o la inconsecuencia.","Pero la situación cambiante en el conjunto de Europa también plantea problemas de una extraordinaria importancia en el campo de la seguridad. Creo que todo el mundo está convencido de que vivimos la mejor oportunidad, desde hace cuarenta años, para garantizar, con una política de desarme firme, una paz mediante el equilibrio en el nivel más bajo posible.","Estableceremos líneas de política exterior claras y reconocibles que proporcionen credibilidad a España frente al exterior. Plantearemos de un modo integral una acción diplomática, económica y cultural en el exterior que sea el fiel reflejo de nuestra sociedad actual.","También aquí la opción estratégica por Europa adquiere pleno sentido. Al hilo de los acontecimientos de los últimos años y bajo la iniciativa de Javier Solana, la Unión Europea está dando pasos, todavía tímidos pero decisivos, para incrementar su propia capacidad de defensa y seguridad en beneficio de sus ciudadanos y para ejercer un papel relevante en pro de la paz en el mundo.","Establecidos de esta forma los objetivos, voy a referirme ahora a las que serán líneas de acción principales en nuestra política exterior. El primer esfuerzo se encaminará a conseguir para nuestro país una definición de política europea, democrática y occidental, clara e irreversible lejos de sueños que puedan delatar una tentación aislacionista respecto del marco occidental. Esta afirmación europea ha de venir acompañada de un componente esencial y distintivo que nos proponemos acrecentar: nuestra relación estrecha con los países iberoamericanos, fundamental por tantas razones que es ocioso reiterar, y que se configura como una constante histórica trascendente a cualquier coyuntura.","Primera. La definición y ejecución de una política exterior que asuma los factores geopolíticos que la condicionan inexorablemente sin perjudicar por ello la independencia da nuestra acción internacional en ciertos ámbitos.","Segundo, la seguridad y defensa nacionales que basaremos en la noción de la suficiencia defensiva.","Nuestra política exterior seguirá promoviendo la solución multilateral de los conflictos. Preferimos la cooperación a la imposición, defendemos la legalidad internacional frente a la arbitrariedad y promoveremos la solidaridad y el respeto frente a los abusos hegemónicos.","La decisión de marchar hacia la accesión a la Alianza Atlántica responde a una coherencia con nuestra concepción general de la política española, pero, ante todo, a una necesidad defensiva y de seguridad. La política exterior, ya lo he dicho antes, es ante todo búsqueda de seguridad. Y es evidente que esa seguridad tiene un componente militar. También es claro que ese componente militar no puede ser, y en este momento nadie lo considera así, un componente aislado. Las prédicas que apuntan hacia una neutralidad, armada o desarmada, no ocultan la realidad de que estas modalidades están fuera de las posibilidades que derivan de nuestros recursos en el primer caso, y ambos fuera de nuestra especialísima situación geoestratégica. No son, por tanto, ni posibles, ni útiles, ni viables.","Y, finalmente, hemos insistido durante varios años, y seguiremos insistiendo en la necesidad de una coordinación internacional. La coordinación internacional en la lucha contra el terrorismo, que hace unos años no era tenida en cuenta por muchos países, hoy se va abriendo camino, y no sólo en la relación bilateral con Francia, que ha incrementado o ha ido desarrollando esas medidas de cooperación y que parece decidida en este momento a incrementarlas hasta el punto de que no haya posibilidad de encontrar un refugio para la acción terrorista que se realiza sobre España en el sur de Francia; esas medidas de cooperación internacional -digo- son un instrumento indispensable para acabar con la lacra del terrorismo.","Tenemos el resuelto propósito de fortalecer nuestra defensa nacional, adaptándola a las exigencias de nuestro tiempo, con la finalidad del mejor cumplimiento del objetivo de seguridad que debe inspirarla. Este objetivo viene delimitado por una triple referencia: la aptitud de nuestras Fuerzas Armadas para llevar a cabo las misiones que tienen constitucionalmente encomendadas, los compromisos con la seguridad colectiva derivados de nuestra pertenencia a la Alianza Atlántica y la voluntad de contribuir a los instrumentos específicos de defensa en el ámbito europeo.","Paso, señorías, a referirme brevemente  a la acción exterior del Estado.","En el amplio espectro que abarca el análisis de los problemas de la sociedad, ocupa un lugar, que he destacado desde el comienzo de mi intervención: la seguridad como garantía de la libertad. El Gobierno cumplirá y hará cumplir la ley. No permitiremos ninguna actuación al margen de la Constitución y los que piensen que pueden violentarla encontrarán una respuesta rigurosa por nuestra parte.","El segundo eje al que dedicará particular atención el Gobierno es el referido a la política exterior.","La seguridad es así una condición básica, social y real, de un régimen de libertad política.","España seguirá activamente presente en las organizaciones internacionales de que forma parte. Continuaremos contribuyendo a las actividades de la diplomacia preventiva y a las misiones humanitarias y de paz.","Independientemente de los proyectos legislativos que el nuevo Gobierno presentará para regular el régimen de libertades diseñado en la Constitución, resulta imprescindible formular, y es nuestro propósito llevar a cabo, una serie de programas de reformas en el campo de la seguridad ciudadana. En este sentido, junto a la garantía jurisdiccional de las libertades públicas, realizaremos una eficaz política de protección de la seguridad ciudadana y una decidida lucha contra el terrorismo.","Segunda. La realización de una política de  defensa nacional en la que las Fuerzas Armadas constituyan por sí mismas un factor de disuasión determinante con capacidad de reacción inmediata, de respaldo de nuestra acción exterior y de defensa del ordenamiento constitucional.","En cualquier caso, nuestra acción privilegiará la diplomacia preventiva y el respeto a los principios de la Carta de las Naciones Unidas frente a la guerra preventiva y al unilateralismo, y hará hincapié en una utilización más eficaz de todos los instrumentos políticos, diplomáticos, económicos y sociales para el arreglo pacífico de controversias. Estoy convencido de que todos necesitamos revisar solidariamente la estrategia en la lucha internacional contra el terrorismo y a ello dedicará su esfuerzo mi Gobierno.","Primero. La necesidad de que todas las fuerzas políticas contribuyan al planteamiento y resolución de los grandes problemas nacionales desde su respectiva órbita ideológica y desde la responsabilidad que les corresponda en función de la posición que asuman en el sistema institucional."],"similitud":[0.802,0.774,0.774,0.772,0.764,0.764,0.759,0.757,0.756,0.756,0.754,0.752,0.75,0.75,0.749,0.748,0.747,0.747,0.747,0.746,0.745,0.745,0.744,0.743,0.742,0.74,0.739,0.738,0.738,0.738,0.738,0.737,0.734,0.734,0.734,0.733,0.732,0.732,0.731,0.731,0.731,0.731,0.73,0.73,0.729,0.729,0.729,0.728,0.728,0.727]},"columns":[{"id":"President","name":"President","type":"character"},{"id":"text","name":"text","type":"character"},{"id":"similitud","name":"similitud","type":"numeric"}],"resizable":true,"dataKey":"dfbc689173a16299e414bf7d08d10262"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Ahora pasamos los resultados se la búsqueda semántica al modelo</p>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"{'Presidente': '"</span>, dx<span class="sc">$</span>President, <span class="st">"', 'Texto': '"</span>, dx<span class="sc">$</span>text, <span class="st">"'}"</span>, <span class="at">collapse =</span> <span class="st">",</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>prompt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Actúa como un experto en el análisis de textos. A continuación tienes una serie de textos Por favor, analiza los textos y responde, con base en los mismos, a la pregunta:"</span>, q, <span class="st">". Genera el resultado en formato markdown. Los textos son los siguientes:</span><span class="sc">\n\n</span><span class="st">'"</span>, tt)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">query</span>(prompt, <span class="at">model=</span><span class="st">"gemma3:27b"</span>, <span class="at">output =</span> <span class="st">"text"</span>, <span class="at">model_params =</span> <span class="fu">list</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="dv">1</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_ctx =</span> <span class="dv">32000</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(out)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="análisis-de-la-posición-de-los-presidentes-frente-a-la-seguridad-ciudadana-y-exterior-y-el-rol-de-organizaciones-internacionales" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-la-posición-de-los-presidentes-frente-a-la-seguridad-ciudadana-y-exterior-y-el-rol-de-organizaciones-internacionales">Análisis de la Posición de los Presidentes frente a la Seguridad (Ciudadana y Exterior) y el Rol de Organizaciones Internacionales</h2>
<p>A partir del análisis de los textos proporcionados, se puede extraer la siguiente información sobre la posición de los presidentes en relación a la seguridad y el papel de las organizaciones internacionales:</p>
<p><strong>I. Posición General Frente a la Seguridad:</strong></p>
<ul>
<li><strong>Prioridad de la Seguridad Nacional:</strong> La gran mayoría de los presidentes (Calvo Sotelo, González, Rajoy, Aznar, Zapatero, Suárez) enfatizan la importancia de la seguridad nacional como un objetivo primordial. Se la considera fundamental para la defensa de los intereses nacionales, la protección de la libertad y el mantenimiento del orden interno.</li>
<li><strong>Conexión Seguridad-Libertad:</strong> Varios presidentes (Calvo Sotelo, González) establecen una relación directa entre seguridad y libertad, argumentando que la seguridad es una condición necesaria para el disfrute de las libertades políticas y civiles.</li>
<li><strong>Enfoque Integral:</strong> La seguridad se aborda de forma integral, abarcando tanto la seguridad ciudadana (lucha contra el terrorismo y el crimen) como la seguridad exterior (defensa del territorio y los intereses nacionales en el ámbito internacional).</li>
<li><strong>Importancia de las Fuerzas Armadas y de Seguridad:</strong> Existe un consenso en la necesidad de mantener unas Fuerzas Armadas y Fuerzas de Seguridad del Estado eficientes y bien equipadas para garantizar la defensa del territorio, la protección de los ciudadanos y la lucha contra el terrorismo.</li>
<li><strong>Énfasis en la Defensa Nacional:</strong> Muchos presidentes (Suárez, Aznar, Rajoy) ponen un énfasis especial en la defensa nacional, entendida como un elemento clave para la protección de los intereses nacionales y la disuasión de posibles amenazas.</li>
</ul>
<p><strong>II. Seguridad Exterior y Organizaciones Internacionales:</strong></p>
<ul>
<li><strong>Alianza Atlántica (OTAN):</strong> La pertenencia a la OTAN es vista por la mayoría de los presidentes como un elemento fundamental para la seguridad exterior de España. Se reconoce su importancia para la disuasión de amenazas, la defensa colectiva y la cooperación en materia de seguridad. Aznar y Zapatero específicamente mencionan el compromiso con la OTAN y la necesidad de contribuir a la seguridad colectiva.</li>
<li><strong>Unión Europea (UE) y Política Común de Seguridad y Defensa (PCSD):</strong> La UE y la PCSD son consideradas como un marco importante para la cooperación en materia de seguridad y defensa. Varios presidentes (Rajoy, Zapatero) destacan la necesidad de fortalecer la capacidad de la UE en materia de seguridad y defensa, así como de promover una mayor integración en este ámbito.</li>
<li><strong>Cooperación Internacional:</strong> La cooperación internacional es vista como un elemento clave para hacer frente a los desafíos de seguridad. Se reconoce la necesidad de colaborar con otros países y organizaciones internacionales para luchar contra el terrorismo, el crimen organizado y otras amenazas transnacionales.</li>
<li><strong>Participación en Organizaciones Internacionales:</strong> Aznar y otros presidentes señalan la importancia de mantener una participación activa en las organizaciones internacionales para promover la paz, la seguridad y el desarrollo.</li>
</ul>
<p><strong>III. Seguridad Ciudadana:</strong></p>
<ul>
<li><strong>Lucha contra el Terrorismo:</strong> La lucha contra el terrorismo es una prioridad para todos los presidentes. Se destaca la necesidad de fortalecer la cooperación internacional, mejorar la inteligencia y reforzar las medidas de seguridad para prevenir y combatir el terrorismo.</li>
<li><strong>Protección de la Seguridad Ciudadana:</strong> Se reconoce la necesidad de garantizar la seguridad ciudadana, proteger a los ciudadanos y mantener el orden público. Se destaca la importancia de fortalecer las Fuerzas y Cuerpos de Seguridad del Estado y mejorar la eficacia de la justicia.</li>
<li><strong>Reforma del Sistema de Seguridad:</strong> Algunos presidentes (Suárez) abogan por la necesidad de reformar el sistema de seguridad para adaptarlo a los nuevos desafíos y garantizar la protección de las libertades públicas.</li>
</ul>
<p><strong>IV. Tendencias y Enfoques Específicos:</strong></p>
<ul>
<li><strong>Calvo Sotelo y Suárez:</strong> Enfatizan la importancia de la disuasión y la defensa nacional como pilares de la seguridad.</li>
<li><strong>González:</strong> Destaca la importancia de la coordinación internacional y la necesidad de una política de seguridad basada en el consenso y la estabilidad.</li>
<li><strong>Aznar:</strong> Prioriza el fortalecimiento de la defensa nacional y la participación activa en las organizaciones internacionales.</li>
<li><strong>Zapatero:</strong> Promueve una política exterior basada en la diplomacia, la cooperación y el respeto al derecho internacional.</li>
<li><strong>Rajoy:</strong> Aboga por una política exterior basada en la estabilidad, la previsibilidad y el consenso.</li>
</ul>
<p><strong>En resumen, la mayoría de los presidentes comparten una visión similar sobre la importancia de la seguridad nacional, la necesidad de mantener unas Fuerzas Armadas y Fuerzas de Seguridad del Estado eficientes y la importancia de la cooperación internacional. Si bien existen matices y diferencias en los enfoques específicos, existe un consenso general sobre la importancia de la seguridad como un elemento clave para el desarrollo y la prosperidad de España.</strong></p>
</section>
<section id="extracción-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="extracción-de-datos">Extracción de datos</h2>
<p>Otro uso que podemos dar a los modelos de IA es la extracción de datos de textos. En muchos casos, los datos que necesitamos están en textos que no están estructurados o que resultan difíciles de extraer de forma organizada. Por ejemplo, en el caso de las actas de reuniones, los informes de asistencia o los resúmenes de eventos, los datos pueden estar dispersos y ser difíciles de analizar. Los modelos LLM pueden ayudarnos a convertir esos datos en tablas o bases de datos que podamos analizar con mayor facilidad.</p>
<p>La figura abajo contiene un listado de asistencia de la sesión plenaria del Congreso de Perú llevada a cabo el 14 de junio de 2017. En total, el documento contiene 9 páginas de asistencia y otras 9 conteniendo votaciones. Infelizmente, el pdf está escaneado y solo podemos acceder a imágenes. Como tarea previa, he llevado a cabo el reconocimiento de caracteres (OCR). Pero aún así, hace falta convertir los datos en una tabla que podamos analizar.</p>
<p><img src="pag_PER.jpg" class="img-fluid"></p>
<p>Como podemos ver, el acta de asistencia está organizado en tres grandes bloques. El primero es la identificación de la sesión, con la fecha, la hora y el período legislativo. El segundo apartado se divide en tres columnas con el grupo parlamentario, los apellidos y los nombres de los diputados y el tipo de asistencia. El bloque final contiene los datos agregados. Nos interesa extraer los datos del segundo bloque y convertirlos en un <code>data.frame</code>.</p>
<p>El primer paso consiste en cargar los textos de asistencia extraidos del pdf original. Ya he creado un objeto <code>RData</code> con los textos que podemos descargar de la nube.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringi)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readtext)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga los datos de texto almacenados </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># en la nube</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url=</span><span class="st">"https://github.com/rodrodr/cieps2025/raw/ccadffc3bbf8f510ae013278336da8a441bf2c0d/asistencias.RData"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Los guarda en el ordenador</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">writeBin</span>(response<span class="sc">$</span>content, <span class="st">"asistencia.Rdata"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga el archivo</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"asistencia.Rdata"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ahora pasamos a la extracción de los datos de los textos. Como en los ejemplos anteriores, he preparado un par de ejemplos para que el modelo pueda identificar qué quiero que extraiga y en qué formato. De forma más concreta, he pedido que separe los datos de un mismo diputado con un punto y coma y que se separen las columnas con un salto de línea.</p>
<p>El modelo elegido ha sido el <code>gemma2:2b</code>, pequeño y rápido, especialmente indicado para grandes volúmenes de texto. Para aumentar la precisión y velocidad, he aislado el segundo bloque con los nombres y, luego, dividi el texto por líenas. De ese modo, en lugar de tener que procesar todos los nombres a la vez, lo hace de forma secuencial, línea a línea (y página a página).</p>
<p>El <code>prompt</code> también lleva en cuenta la tarea a llevar a cabo, la extracción de datos, la estructura de la información, las posibilidades de identificación de los diferentes tipos de ausencia.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un conjunto de ejemplos</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># para extraer los datos</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>eje <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>text, <span class="sc">~</span>answer,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"APP ACUÑA NUÑEZ, RICHARD aus PPK FLORES VÍLCHEZ, CLEMENTE PRE FA QUINTANILLA CHACÓN, ALBERTO PRE"</span>,<span class="st">"APP;ACUÑA NUÑEZ, RICHARD;AUS</span><span class="sc">\n</span><span class="st">PPK;FLORES VÍLCHEZ, CLEMENTE;PRE</span><span class="sc">\n</span><span class="st">FA;QUINTANILLA CHACÓN, ALBERTO;PRE"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GPFP AGUILAR MONTENEGRO, WILMER PRE FA FORONDA FARRO, MARÍA ELENA aus GPFP RAMÍREZ GAMARRA, OSÍAS LO"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GPFP;AGUILAR MONTENEGRO, WILMER;PRE</span><span class="sc">\n</span><span class="st">FA;FORONDA FARRO, MARÍA ELENA;aus</span><span class="sc">\n</span><span class="st">GPFP;RAMÍREZ GAMARRA, OSÍAS ;LO"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GPFP FIGUEROA MINAYA, MODESTO PRE GPFP PONCE VILLARREAL DE V., YESENIA aus"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GPFP;FIGUEROA MINAYA, MODESTO;PRE</span><span class="sc">\n</span><span class="st">GPFP;PONCE VILLARREAL DE V., YESENIA;aus"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Elije el modelo</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="st">"gemma2:2b"</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un conjunto de datos vacío</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># para acumular los resultados</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Para cada archivo de texto</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># (por temas de tiempo, solo se</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># procesarán los primeros 2)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lee las líneas del texto</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(tx<span class="sc">$</span>text[i])</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Encuentra la seccion del </span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># texto que contiene la información</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">stri_detect_fixed</span>(ll, <span class="st">"ASISTENCIA"</span>)<span class="sc">==</span><span class="cn">TRUE</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extrae la sección del texto</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># deseada</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> ll[(nn[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nn[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)]</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crea una consulta</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">make_query</span>(</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">template =</span> <span class="st">"{text}</span><span class="sc">\n</span><span class="st">{prompt}"</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> ll,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">prompt =</span> <span class="st">"Utilizando las instrucciones anteriores como referencia, retorna una tabla con tres variables -grupo, diputado, status- separada por ; con los datos del texto para devolver solo la tabla con los datos extraídos: Grupo;diputado;status. OUTPUT: grupo;diputado;status"</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">system =</span> <span class="st">"Eres un modelo experto en extracción de atributos de un texto. A continuación se le proporciona un texto con informaciones sobre personas que han asistido a los plenos de debates del congreso de diputados de Perú. Los nombres se encuentran divididos en tres columnas. La información de cada diputado aparece como GRUPO APELLIDOS, NOMBRES STATUS, donde Grupo es el grupo parlamentario a que pertenece, Apellidos son los apellidos de la persona en cuestión, Nombres contiene los nombres de la persona y STATUS corresponde si ha estado presente (PRE), ausente (aus) o licenciado (LO/LE), fallecido (F), en la Junta de Portavoces (JP). NUNCA introduzca comentarios más allá del formato de salida deseado."</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">examples =</span> eje)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Realiza la consulta</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">query</span>(q, </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">model =</span> modelo, </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">screen =</span> F, </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">output =</span> <span class="st">"data.frame"</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>               <span class="at">verbose =</span> F,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">model_params =</span> <span class="fu">list</span>(</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span><span class="dv">123</span>,</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">temperature=</span><span class="dv">0</span>))</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convierte la salida en un data.frame</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  la <span class="ot">&lt;-</span> <span class="fu">paste</span>(out<span class="sc">$</span>response, <span class="at">collapse=</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  la <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(la, <span class="at">delim=</span><span class="st">";"</span>, </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> F,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types=</span>F)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añade el id del documento</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  la<span class="sc">$</span>doc <span class="ot">&lt;-</span> tx<span class="sc">$</span>doc_id[i]</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Acumula los resultados</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d, la)</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Muestra los resultados</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(d, </span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">sortable =</span> T, </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">resizable =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-42e75f27da5cce27fb06" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-42e75f27da5cce27fb06">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"X1":["PPK","PPK","FA","GPFP","FA","GPFP","GPFP","GPFP","GPFP","GPEP","GPFP","GPFP","GPFP","GPFP","APP","GPFP","GPFP","GPFP","GPFP","GPFP","CPA","FA","FA","AP","GPFP","GPFP","APP","FA","PPK","FA","PPK","PPK","GPFP","FA","GPFP","GPFP","GPFP","FA","GPFP","GPFP","FA","GPFP","GPFP","GPEP","GPFP","GPFP","CPA","PPK","GPFP","AP","GPFP","GPFP","GPFP","GPFP","PPK","GPFP","GPFP","GPFP","PPK","PPK","FA","GPFP","GPFP","FA","GPFP","GPFP","GPFP","GPFP","GPFP","FA","GPFP","GPFP","GPFP","PPK","GPEP","GPFP","GPFP","GPFP","PPK","GPFP","FA","PPK","GPFP","GPFP","GPFP","APP","APP","FA","GPFP","CPA","FA","FA","GPFP","PPK","CPA","GPFP","PPK","APP",null,"GPFP","GPEP",null,"AP","FA","APP","PPK","PPK","AP","GPFP","PPK","GPFP","GPFP","FA","PPK","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","FA","GPFP","FA","PPK","GPFP","GPFP","GPFP","GPFP","PPK","PPK","FA","GPFP","FA","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","APP","GPFP","GPFP","GPFP","GPFP","GPFP","CPA","FA","FA","FA","GPFP","GPFP","APP","FA","PPK","FA","PPK","PPK","GPFP","FA","GPFP","GPFP","GPFP","FA","GPFP","GPFP","FA","GPFP","GPFP","GPFP","GPFP","GPFP","CPA","PPK","GPFP","AP","GPFP","GPFP","GPFP","GPFP","PPK","GPFP","GPFP","GPFP","PPK","PPK","FA","GPFP","GPFP","FA","GPEP","GPFP","GPFP","GPFP","GPFP","FA","GPFP","GPFP","GPFP","PPK","GPFP","GPFP","GPFP","GPFP","PPK","GPFP","FA","PPK","GPFP","GPFP","GPFP","APP","APP","FA","GPFP","CPA","FA","FA","GPFP","PPK","CPA","GPFP","PPK","APP",null,"GPFP","GPFP",null,"AP","FA","APP","CPA","PPK","AP","GPFP","PPK","GPFP","GPFP","FA","PPK","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","GPFP","FA","GPFP","FA","PPK","GPFP","GPFP","GPFP","GPFP"],"X2":["ACUÑA NUÑEZ, RICHARD","FLORES VÍLCHEZ, CLEMENTE","QUINTANILLA CHACÓN, ALBERTO","AGUILAR MONTENEGRO, WILMER","FORONDA FARRO, MARÍA ELENA","RAMÍREZ GAMARRA, OSÍAS","ALBRECHT RODRÍGUEZ, VÍCTOR","FUJIMORI HIGUCHX, KENJI GERARDO","RAMÍREZ TANDAZO, BIENVENIDO","ALCALÁ MATEO, PERCY","GALARRETA VELARDE, LUIS","REÁTEGUI FLORES, ROLANDO","ALCORTA SUERO, LOURDES","GALVÁN VENTO, CLAYTON","RÍOS OCSA, BENICIO","ANANCULI GÓMEZ, BETTY","AP GARCÍA BELAUNDE, VÍCTOR ANDRÉS","ROBLES URIBE, LIZBETH","ANDRADE SALGUERO DE A., GLADYS","GARCÍA JIMÉNEZ, MARITZA","RODRÍGUEZ ZAVALETA, ELÍAS","APAZA ORDÓÑEZ, JUSTINIANO","GLAVE REMY, MARISA","ROMÁN VALDIVIA, MIGUEL","ARAMAYO GAONA, ALEJANDRA","GONZALES ARDILES, JUAN CARLOS","ROSAS HUARANGA, JULIO","ARANA ZEGARRA, MARCO","GUÍA PIANTO, MOISÉS","ROZAS BELTRÁN, WILBERT","ARÁOZ FERNÁNDEZ, MERCEDES","HERESI CHICOMA, SALVADOR","SAAVEDRA VELA, ESTHER","ARCE CÁCERES, RICHARD","HERRERA ARÉVALO, MARITA","SALAVERRY VILLA, DANIEL","ARIMBORGO GUERRA, TAMAR","HUILCA FLORES, INDIRA","SALAZAR DE LA TORRE, MILAGROS","ÁVILA ROJAS, LUCIO","LAP A INGA, ZACARÍAS","SALAZAR MIRANDA, OCTAVIO","BARTRA BARRIGA, ROSA MARÍA","LAZO JULCA, ISRAEL","SALGADO RUBIANES, LUZ","BECERRIL RODRÍGUEZ, HÉCTOR","LEÓN ROMERO, LUCIANA","SÁNCHEZ ALVA, JANET","BETETA RUBÍN, KARINA","LESCANO ANCIETA, YONHY","SARMIENTO BETANCOURT, FREDDY","BOCANGEL WEYDERT, GUILLERMO","LETONA PEREYRA, ÚRSULA","SCHAEFER CUCULIZA, KARLA","BRUCE MONTES DE OCA, CARLOS","LIZANA SANTOS, MÁRTIRES","SEGURA IZQUIERDO, CÉSAR","BUSTOS ESPINOZA, ESTELITA","LOMBARDI ELÍAS, GUIDO","SHEPUT MOORE, JUAN","CANZIO ÁLVAREZ, MARIO","LOPEZ VILELA, LUIS","TAKAYAMA JIMÉNEZ, MILAGROS","CASTRO BRAVO, JORGE","MAMANI COLQUEHUANCA, MDISÉS","TAPIA BERNAL, SEGUNDO","CASTRO GRÁNDEZ, MIGUEL","MANTILLA MEDINA, MARIO","TICLLA RAFAEL, CARLOS","CEVALLOS FLORES, HERNANDO","MARTORELL SOBERO, GUILLERMO","TORRES MORALES, MIGUEL","CHACÓN DE VETTORI, CECILIA","MELÉNDEZ CELIS, JORGE","TRUJILLO ZEGARRA, GILMER","CHIHUÁN RAMOS, LEYLA","MELGAR VALDEZ, ELARD","TUBINO ARIAS SCHREIBER, CARLOS","CHOQUEHUANCA DE V., ANA MARÍA","MELGAREJO PÁUCAR, MARÍA","TUCTO CASTILLO, ROGELIO","COSTA SANTOLALLA, GINO","MIYASHIRO ARASHIRO, MARCO","USHÑAHUA HUASANGA, GLIDER","CUADROS CANDIA, NELLY","MONTENEGRO FIGUEROA, GLORIA","VÁSQUEZ SÁNCHEZ, CÉSAR","CURRO LÓPEZ, EDILBERTO","MONTEROLA ABREGÚ, WUILIAN","VELÁSQUEZ QUESQUÉN, JAVIER","DAMMERT EGO AGUIRRE, MANUEL","MORALES RAMÍREZ, EDYSON","VENTURA ÁNGEL, ROY","DÁVILA VIZCARRA, SERGIO","MULDER BEDOYA, MAURICIO","VERGARA PINTO, EDWIN","DE BELAUNDE DE CÁRDENAS, ALBERTO","NARVÁEZ SOTO, ELOY","VIEIRA, ROBERTO","DEL ÁGUILA CÁRDENAS, JUAN CARLOS","NOCEDA CHIANG, PALOMA","VILCATOMA DE LA CRUZ, YENI","DEL ÁGUILA HERRERA, EDMUNDO","OCHOA PEZO, EDGAR","VILLANUEVA ARÉVALO, CÉSAR","DEL CASTILLO GÁLVEZ, JORGE","OLAECHIA ÁLVAREZ CALDERÓN, PEDRO","VILLANUEVA MERCADO, ARMANDO","DIPAS HUAMÁN, JOAQUÍN","OLIVA CORRALES, ALBERTO","VILLAVICENCIO CÁRDENAS, FRANCISCO","DOMINGUEZ HERRERA, CARLOS","PACORT MAMANI, ORACIO","VIOLETA LÓPEZ, GILBERT","APP DONAYRE GOTZCH, EDWIN","PALMA MENDOZA, JOSÉ","YIKA GARCÍA, LUIS","DONAYRE PASQUEL, PATRICIA","PALOMINO ORTIZ, DALMIRO","YUYES MEZA, JUAN CARLO","ECHEVARRÍA HUAMÁN, SONIA","PARIONA GALINDO, FEDERICO","ZEBALLOS PATRÓN, HORACIO","ELÍAS ÁVALOS, MIGUEL ÁNGEL","PARIONA TARQUI, TANIA","ZEBALLOS SALINAS, VICENTE","APP ESPINOZA CRUZ, MARISOL","PETROZZI FRANCO, FRANCISCO","FIGUEROA MINAYA, MODESTO","PONCE VILLARREAL DE V., YESENIA","ACUÑA NÚÑEZ, RICHARD","FLORES VÍLCHEZ, CLEMENTE","QUINTANILLA CHACÓN, ALBERTO","AGUILAR MONTENEGRO, WILMER","FORONDA FARRO, MARÍA ELENA","RAMÍREZ GAMARRA, OSÍAS","ALBRECHT RODRÍGUEZ, VÍCTOR","FUJIMORI HIGUCHI, KENJI GERARDO","RAMÍREZ TANDAZO, BIENVENIDO","ALCALÁ MATEO, PERCY","GALARRETA VELARDE, LUIS","REÁTEGUI FLORES, ROLANDO","ALCORTA SUERO, LOURDES","GALVÁN VENTO, CLAYTON","RÍOS OCSA, BENICIO","ANANCULI GÓMEZ, BETTY","AP GARCÍA BELAUNDE, VÍCTOR ANDRÉS","ROBLES URIBE, LEIZBETH","ANDRADE SALGUERO DE A., GLADYS","GARCÍA JIMÉNEZ, MARITZA","RODRÍGUEZ ZAVALETA, ELÍAS","APAZA ORDÓÑEZ, JUSTINIANO","GLAVE REMY, MARISA","AP ROMÁN VALDIVIA, MIGUEL","ARAMAYO GAONA, ALEJANDRA","GONZALES ARDILES, JUAN CARLOS","ROSAS HUARANGA, JULIO","ARANA ZEGARRA, MARCO","GUÍA PIANTO, MOISÉS","ROZAS BELTRÁN, WILBERT","ARÁOZ FERNÁNDEZ, MERCEDES","HERESI CHICOMA, SALVADOR","SAAVEDRA VELA, ESTHER","ARCE CÁCERES, RICHARD","HERRERA ARÉVALO, MARITA","SALAVERRY VILLA, DANIEL","ARIMBORGO GUERRA, TAMAR","HUILCA FLORES, INDIRA","SALAZAR DE LA TORRE, MILAGROS","ÁVILA ROJAS, LUCIO","LAP A INGA, ZACARÍAS","SALAZAR MIRANDA, OCTAVIO","BARTRA BARRIGA, ROSA MARÍA","LAZO JULCA, ISRAEL","SALGADO RUBIANES, LUZ","BECERRIL RODRÍGUEZ, HÉCTOR","LEÓN ROMERO, LUCIANA","SÁNCHEZ ALVA, JANET","BETETA RUBÍN, KARINA","LESCANO ANCIETA, YONHY","SARMIENTO BETANCOURT, FREDDY","BOCANGEL WEYDERT, GUILLERMO","LETONA PEREYRA, ÚRSULA","SCHAEFER CUCULIZA, KARLA","BRUCE MONTES DE OCA, CARLOS","LIZANA SANTOS, MÁRTIRES","SEGURA IZQUIERDO, CÉSAR","BUSTOS ESPINOZA, ESTELITA","LOMBARDI ELÍAS, GUIDO","SHEPUT MOORE, JUAN","CANZIO ÁLVAREZ, MARIO","LOPEZ VILELA, LUIS","TAKAYAMA JIMÉNEZ, MILAGROS","CASTRO BRAVO, JORGE","MAMANI COLQUEHUANCA, MOISÉS","TAPIA BERNAL, SEGUNDO","CASTRO GRÁNDEZ, MIGUEL","MANTILLA MEDINA, MARIO","TICLLA RAFAEL, CARLOS","CEVALLOS FLORES, HERNANDO","MARTORELL SOBERO, GUILLERMO","TORRES MORALES, MIGUEL","CHACÓN DE VETTORI, CECILIA","MELÉNDEZ CELIS, JORGE","TRUJILLO ZEGARRA, GILMER","CHIHUÁN RAMOS, LEYLA","MELGAR VALDEZ, ELARD","TUBINO ARTAS SCHREIBER, CARLOS","CHOQUEHUANCA DE V., ANA MARÍA","MELGAREJO PÁUCAR, MARÍA","TUCTO CASTILLO, ROGELIO","COSTA SANTOLALLA, GINO","MIYASHIRO ARASHIRO, MARCO","USHÑAHUA HUASANGA, GLIDER","CUADROS CANDIA, NELLY","MONTENEGRO FIGUEROA, GLORIA","VÁSQUEZ SÁNCHEZ, CÉSAR","CURRO LÓPEZ, EDILBERTO","MONTEROLA ABREGÚ, WUILIAN","VELÁSQUEZ QUESQUÉN, JAVIER","DAMMERT EGO AGUIRRE, MANUEL","MORALES RAMÍREZ, EDYSON","VENTURA ÁNGEL, ROY","DÁVILA VIZCARRA, SERGIO","MULDER BEDOYA, MAURICIO","VERGARA PINTO, EDWIN","DE BELAUNDE DE CÁRDENAS, ALBERTO","NARVÁEZ SOTO, ELOY","VIEIRA, ROBERTO","DEL ÁGUILA CÁRDENAS, JUAN CARLOS","NOCEDA CHIANG, PALOMA","VILCATOMA DE LA CRUZ, YENI","DEL ÁGUILA HERRERA, EDMUNDO","OCHOA PEZO, ÉDGAR","VILLANUEVA ARÉVALO, CÉSAR","DEL CASTILLO GÁLVEZ, JORGE","OLAECHEA ÁLVAREZ CALDERÓN, PEDRO","VILLANUEVA MERCADO, ARMANDO","DIPAS HUAMÁN, JOAQUÍN","OLIVA CORRALES, ALBERTO","VILLAVICENCIO CÁRDENAS, FRANCISCO","DOMÍNGUEZ HERRERA, CARLOS","PACORI MAMANI, ORACIO","VIOLETA LÓPEZ, GILBERT","APP DONAYRE GOTZCH, EDWIN","PALMA MENDOZA, JOSÉ","YIKA GARCÍA, LUIS","DONAYRE PASQUEL, PATRICIA","PALOMINO ORTIZ, DALMIRO","YUYES MEZA, JUAN CARLO","ECHEVARRÍA HUAMÁN, SONIA","PARIONA GALINDO, FEDERICO","ZEBALLOS PATRÓN, HORACIO","ELÍAS ÁVALOS, MIGUEL ÁNGEL","PARIONA TARQUÍ, TANIA","ZEBALLOS SALINAS, VICENTE","APP ESPINOZA CRUZ, MARISOL","PETROZZI FRANCO, FRANCISCO","FIGUEROA MINAYA, MODESTO","PONCE VILLARREAL DE V., YESENIA"],"X3":["AUS","PRE","PRE ","PRE","aus","LO ","PRE","PRE","PRE ","PRE","PRE","PRE ","LE","aus","LO ","PRE","PRE","PRE ","PRE","PRE","PRE ","aus","PRE","PRE ","PRE","PRE","aus ","aus","PRE","PRE ","PRE","LO","PRE ","PRE","aus","PRE ","LO","aus","LO ","PRE","PRE","aus ","aus","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","LE ","PRE","PRE","aus ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","LO","PRE","PRE ","aus","aus","PRE ","aus","PRE","PRE ","LO","aus","LO ","PRE","aus","aus ","PRE","PRE","LE ","LO","PRE","LO ","PRE","aus","aus ","PRE","PRE","PRE ","AUS","PRE","PRE ","PRE","PRE","aus ","PRE","PRE","PRE ","PRE","PRE","LE ","aus","LO","PRE ","PRE","LE","PRE ","PRE","PRE","PRE ","PRE","LE","PRE ","aus","PRE","PRE ","PRE","aus","PRE ","aus","PRE","aus ","LO","PRE ","PRE","aus ","PRE","PRE","PRE ","PRE","aus","LO ","PRE","PRE","PRE ","PRE","PRE","PRE ","LE","PRE","PRE ","PRE","aus","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","LO","PRE ","PRE","aus","aus ","LO","PRE","LO ","PRE","PRE","PRE ","PRE","PRE","aus ","aus","PRE","PRE ","PRE","PRE","LE ","PRE","LE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","LO","PRE","PRE ","aus","PRE","PRE ","PRE","PRE","PRE ","LO","PRE","LO ","PRE","PRE","PRE ","PRE","PRE","LE ","LO","PRE","LO ","PRE","aus","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","PRE","PRE","LE ","PRE","PRE","LE ","PRE","LO","LE ","PRE","LE","PRE ","PRE","PRE","PRE ","PRE","LE","PRE ","PRE","PRE","PRE ","PRE","PRE","PRE ","aus","PRE","PRE ","LO","PRE ","PRE","aus "],"doc":["ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_1.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt","ASIS__0-AS-VOT-14-06-17-OFICIAL_10.txt"]},"columns":[{"id":"X1","name":"X1","type":"character"},{"id":"X2","name":"X2","type":"character"},{"id":"X3","name":"X3","type":"character"},{"id":"doc","name":"doc","type":"character"}],"resizable":true,"dataKey":"2d4126fa9dbc25fadcc51dd372ab2259"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Como vemos, el modelo ha sido capaz de identificar 260 observaciones para tres variables, 130 para cada uno de los dos textos. Esa información ya está lista para ser analizada. Le he añadido también el nombre del archivo original, que me permite identificar a qué sesión, fecha y documento <em>.pdf</em> pertenece cada asistencia.</p>
</section>
<section id="análisis-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-datos">Análisis de datos</h2>
<p>También podemos pedir a los modelos de IA que realice análisis de datos. En el código a continuación, utilizamos una base de datos sobre los países del mundo contenida en el paquete <code>poliscidata</code> (con datos de Pollock and Edwards, <em>an R Companion to Essentials of Political Analysis</em>) para pedir que el modelo interprete los datos y el resultado de correlaciones -entre democracia y fraccionamiento étnico, por ejemplo- y un teste t de Student de la media en el índice de democratización entre países de mayoría musulmana y no musulmana. Se tratan de relaciones complejos y que representan retos para cualquier analista, no solo una IA. Veamos los resultados:</p>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga el paquete con los datos</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poliscidata)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepara los datos</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> world</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> w[, <span class="fu">c</span>(<span class="st">"country"</span>,<span class="st">"dem_level4"</span>, <span class="st">"dem_score14"</span>, <span class="st">"frac_eth"</span>, <span class="st">"muslim"</span>, <span class="st">"pop_65_older"</span>)]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(w) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Democracy_Level"</span>, <span class="st">"Democracy_Score"</span>, <span class="st">"Ethnic_Fractionalization"</span>, <span class="st">"Muslim_Majority"</span>, <span class="st">"Population_65_and_Older"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforma en una tabla de texto</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>(w)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Genera las correlaciones</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>co <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(w[,<span class="fu">c</span>(<span class="st">"Democracy_Score"</span>, <span class="st">"Ethnic_Fractionalization"</span>,<span class="st">"Population_65_and_Older"</span>)], <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>),<span class="dv">3</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforma en una tabla de texto</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>co <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>(co)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuta el test t de Student</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">t.test</span>(w<span class="sc">$</span>Democracy_Score<span class="sc">~</span>w<span class="sc">$</span>Muslim_Majority, <span class="at">conf.level=</span><span class="fl">0.99</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea el prompt</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>prompt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Actúa como un analista de datos de las ciencias sociales. Tu tarea consiste en analizar dos tablas con datos. La primera tabla contiene información nivel de democracia, el índice de democracia, la diversidad étnica, si la mayoría de la población es musulmana y el porcentaje de la población con 65 años o más en diversos países. Los datos de la tabla son los siguientes: </span><span class="sc">\n\n</span><span class="st">"</span>,wt, <span class="st">"</span><span class="sc">\n\n</span><span class="st"> y la tabla de correlaciones entre el índice de democracia, la fracionalización étnica y el porcentaje de personas con 65 años o más es la siguiente: </span><span class="sc">\n\n</span><span class="st">"</span>, co, <span class="st">".</span><span class="sc">\n\n</span><span class="st">Los resultados del teste t de diferencia entre medias entre el índice de democracia y si el país posee una mayoría musulmana es el siguiente: </span><span class="sc">\n\n</span><span class="st">"</span>, tt,<span class="st">"</span><span class="sc">\n\n</span><span class="st">. Con base en esos datos: </span><span class="sc">\n\n</span><span class="st">1) realiza un análisis descriptivo de las variables; 2) realiza un análisis entre nivel de democracia y diversidad étnica; 3) realiza un análisis entre el índice de democracia y la mayoría musulmana; y, finalmente, 4) realiza un análisis entre el mayoría musulmana y la diversidad étnica.</span><span class="sc">\n\n</span><span class="st">Una vez realizo el análisis, escribe una síntesis de unas 2000 palabras sobre el tema."</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuta el modelo</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellmer)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">"gemini-2.0-flash-lite"</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>chat <span class="ot">&lt;-</span> <span class="fu">chat_gemini</span>(</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">base_url =</span> <span class="st">"https://generativelanguage.googleapis.com/v1beta/"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_args =</span> <span class="fu">list</span>(<span class="at">generationConfig =</span> </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">list</span>(<span class="at">temperature=</span><span class="dv">1</span>, </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                         <span class="at">seed=</span><span class="dv">1234</span>)),  </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> model, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo=</span><span class="st">"none"</span>)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> chat<span class="sc">$</span><span class="fu">chat</span>(prompt)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Devuelve la respuesta</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(out)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="análisis-de-datos-sobre-democracia-diversidad-étnica-y-religión" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-datos-sobre-democracia-diversidad-étnica-y-religión">Análisis de Datos sobre Democracia, Diversidad Étnica y Religión</h2>
<p><strong>Introducción</strong></p>
<p>Este análisis examina la relación entre el nivel de democracia, el índice de democracia, la diversidad étnica, la predominancia de la población musulmana y el porcentaje de población de 65 años o más en diversos países. El objetivo es identificar patrones y correlaciones entre estas variables, proporcionando una comprensión más profunda de cómo interactúan los factores sociopolíticos y demográficos.</p>
<p><strong>1. Análisis Descriptivo de las Variables</strong></p>
<p>Antes de profundizar en las relaciones entre las variables, es fundamental realizar un análisis descriptivo de cada una de ellas. Esto incluye la identificación de la escala de medición, la tendencia central, la dispersión y la distribución de cada variable. Dado que cada país tiene un valor para cada variable, es posible observar la distribución de la información:</p>
<ul>
<li><p><strong>Democracy_Level (Nivel de Democracia):</strong> Esta variable es categórica ordinal. Los niveles de democracia (Authoritarian, Hybrid, Part Democ, Full Democ) representan una clasificación jerárquica del régimen político de cada país. Podemos observar la frecuencia con la que cada categoría aparece en los datos.</p></li>
<li><p><strong>Democracy_Score (Índice de Democracia):</strong> Esta variable es continua. Representa una puntuación que refleja el grado de democracia en cada país, probablemente basada en una escala de 0 a 10 o similar. El análisis descriptivo incluirá medidas de tendencia central (media, mediana) y dispersión (desviación estándar, rango) para comprender la variación en los puntajes de democracia. Es útil evaluar la distribución (asimetría, curtosis) para determinar si es normal o si existen valores atípicos.</p></li>
<li><p><strong>Ethnic_Fractionalization (Fraccionalización Étnica):</strong> Esta variable es continua. Representa la diversidad étnica en cada país, probablemente medida a través de un índice que cuantifica la probabilidad de que dos individuos seleccionados aleatoriamente pertenezcan a diferentes grupos étnicos. El análisis descriptivo incluirá medidas de tendencia central y dispersión, y la distribución para entender la diversidad étnica en la muestra.</p></li>
<li><p><strong>Muslim_Majority (Mayoría Musulmana):</strong> Esta variable es categórica nominal, con dos categorías: “Yes” (Sí) y “No”. Indica si la mayoría de la población del país es musulmana. El análisis descriptivo se enfocará en la frecuencia de cada categoría en los datos.</p></li>
<li><p><strong>Population_65_and_Older (Población de 65 Años y Mayor):</strong> Esta variable es continua. Representa el porcentaje de la población que tiene 65 años o más. El análisis descriptivo incluirá medidas de tendencia central y dispersión, y la distribución para comprender el envejecimiento poblacional en los diferentes países.</p></li>
</ul>
<p><strong>2. Análisis entre Nivel de Democracia y Diversidad Étnica</strong></p>
<p>La relación entre el nivel de democracia y la diversidad étnica se explorará principalmente a través del cruce de datos.</p>
<ul>
<li><p><strong>Análisis descriptivo:</strong> Se calculará el valor promedio del índice de diversidad étnica para cada nivel de democracia. Esto permite identificar si, por ejemplo, los países con “Full Democ” tienden a tener una diversidad étnica mayor, menor o similar a los países con regímenes “Authoritarian”.</p></li>
<li><p><strong>Visualización:</strong> Se usarán gráficos de barras o diagramas de caja para visualizar la distribución de la diversidad étnica en cada nivel de democracia. Esto permite comparar visualmente las diferencias en la diversidad étnica entre los diferentes tipos de régimen.</p></li>
</ul>
<p><strong>3. Análisis entre el Índice de Democracia y la Mayoría Musulmana</strong></p>
<p>Este análisis busca determinar si existe una relación entre el índice de democracia de un país y la presencia o ausencia de una mayoría musulmana.</p>
<ul>
<li><p><strong>Prueba t de diferencia de medias:</strong> El resultado proporcionado (por ejemplo, <code>t = 8.69076461000291</code>, <code>df = 120.77141729791</code>, <code>p-value = 2.10442008073389e-14</code>) se interpreta así:</p>
<ul>
<li><p><strong>t:</strong> El valor t indica la magnitud de la diferencia entre las medias de los dos grupos (países con y sin mayoría musulmana). Un valor t mayor sugiere una diferencia más significativa.</p></li>
<li><p><strong>df:</strong> Los grados de libertad (df) reflejan el tamaño de la muestra. Indican cuánta “libertad” tienen los datos para variar.</p></li>
<li><p><strong>p-value:</strong> El valor p es crucial. Representa la probabilidad de obtener los resultados observados (o resultados aún más extremos) si no hubiera una diferencia real entre las medias de los grupos. Un valor p pequeño (generalmente menor a 0.05) sugiere que la diferencia observada es estadísticamente significativa, es decir, es poco probable que ocurra por azar.</p></li>
<li><p>Con un valor p muy pequeño (como 2.10442008073389e-14) se rechaza la hipótesis nula de que no hay diferencia en el índice de democracia entre países con y sin mayoría musulmana. Esto indica una diferencia significativa en el índice de democracia entre estos dos grupos de países. Se debe examinar la media del índice de democracia para cada grupo (proporcionada por el paquete de datos) para determinar la dirección de la relación.</p></li>
</ul></li>
<li><p><strong>Visualización:</strong> Se puede usar un diagrama de caja o un diagrama de barras para comparar visualmente el índice de democracia en países con y sin mayoría musulmana.</p></li>
</ul>
<p><strong>4. Análisis entre Mayoría Musulmana y Diversidad Étnica</strong></p>
<p>Este análisis investigará si existe una relación entre la presencia de una mayoría musulmana y la diversidad étnica.</p>
<ul>
<li><p><strong>Análisis descriptivo:</strong> Se calculará el valor promedio de la diversidad étnica para los países con y sin mayoría musulmana. Esto permite identificar si los países con mayorías musulmanas tienden a tener una diversidad étnica mayor, menor o similar a los países sin mayorías musulmanas.</p></li>
<li><p><strong>Visualización:</strong> Se usará un diagrama de caja o un diagrama de barras para visualizar la distribución de la diversidad étnica en los países con y sin mayoría musulmana.</p></li>
</ul>
<p><strong>Síntesis (2000 palabras)</strong></p>
<p>El análisis de los datos proporcionados, aunque limitado por la falta de acceso a la información de las variables por país y la necesidad de más datos, permite realizar inferencias sobre la relación entre democracia, diversidad étnica, religión y demografía. A continuación, se presenta una síntesis que integra los hallazgos potenciales, considerando las limitaciones de la información.</p>
<p><strong>Democracia y Diversidad Étnica: Un Vínculo Complejo</strong></p>
<p>La relación entre democracia y diversidad étnica es uno de los temas centrales en las ciencias sociales. Teóricamente, la democracia, con su énfasis en los derechos individuales, la igualdad ante la ley y la participación política, debería ser un entorno propicio para la coexistencia pacífica de diferentes grupos étnicos. La protección de los derechos de las minorías y la inclusión en el proceso político son pilares fundamentales de la democracia liberal.</p>
<p>Sin embargo, la realidad es más compleja. La diversidad étnica, por sí sola, no garantiza la democracia. De hecho, en algunos casos, puede representar un desafío para la estabilidad política y el desarrollo democrático. Los conflictos étnicos, la discriminación y la exclusión social pueden socavar los principios democráticos y conducir a la inestabilidad.</p>
<ul>
<li><strong>Países con alta diversidad étnica y democracias consolidadas:</strong> Suiza, Canadá y Nueva Zelanda, que muestran niveles de democracia “Full Democ” y alta diversidad étnica (datos hipotéticos), ilustran cómo la integración social, la protección de los derechos de las minorías y un sistema político inclusivo pueden facilitar la coexistencia pacífica de diferentes grupos étnicos y la consolidación de la democracia.</li>
<li><strong>Países con alta diversidad étnica y democracias frágiles o autoritarias:</strong> En contraste, países como Nigeria y el Congo (hipotéticos) pueden demostrar cómo la diversidad étnica, combinada con la corrupción, la inestabilidad política y la discriminación, puede dificultar el desarrollo democrático y aumentar el riesgo de conflicto. En estos casos, la diversidad étnica puede ser un factor de inestabilidad, exacerbando las tensiones sociales y políticas.</li>
</ul>
<p><strong>Democracia, Religión y el Papel de la Mayoría Musulmana</strong></p>
<p>El análisis de la relación entre el índice de democracia y la presencia de una mayoría musulmana (a través de la prueba t) es particularmente interesante. El resultado “2.10442008073389e-14” (p-value) indica una diferencia significativa entre el índice de democracia de países con y sin mayoría musulmana. Esta diferencia puede ser el resultado de múltiples factores y no implica causalidad directa. Es crucial examinar la media del índice de democracia para cada grupo (no disponible en los datos presentados) para determinar la dirección de la relación.</p>
<ul>
<li><p><strong>Si el índice de democracia es significativamente menor en países con mayoría musulmana:</strong> Esto podría sugerir que existen factores asociados con el contexto sociopolítico de algunos países con mayoría musulmana que dificultan el desarrollo democrático. Estos factores podrían incluir:</p>
<ul>
<li><strong>Influencia de regímenes autoritarios:</strong> Muchos países con mayoría musulmana han experimentado o experimentan regímenes autoritarios o regímenes con limitadas libertades políticas. La falta de instituciones democráticas sólidas y la represión de la disidencia pueden afectar negativamente el índice de democracia.</li>
<li><strong>Radicalización y extremismo:</strong> En algunos casos, la radicalización y el extremismo religioso han generado conflictos internos y han socavado la gobernabilidad democrática.</li>
<li><strong>Contexto histórico y cultural:</strong> El legado colonial, la influencia de potencias extranjeras y las dinámicas internas de cada país también influyen en la calidad de la democracia.</li>
</ul></li>
<li><p><strong>Si el índice de democracia es significativamente mayor en países con mayoría musulmana:</strong> Esta situación, aunque menos probable, también podría ser posible. En este caso, se debe investigar si existen factores específicos que promueven la democracia en esos contextos. Estos factores podrían incluir:</p>
<ul>
<li><strong>Movimientos sociales y políticos:</strong> La existencia de movimientos sociales y políticos que promueven la democratización y los derechos humanos, incluso en contextos religiosos.</li>
<li><strong>Adaptación de valores religiosos:</strong> La adaptación e interpretación de los valores religiosos para ser compatibles con la democracia y los derechos humanos.</li>
<li><strong>Sociedades civiles activas:</strong> La presencia de una sociedad civil fuerte y activa que defienda los principios democráticos.</li>
</ul></li>
</ul>
<p><strong>El Entrelazamiento de la Diversidad Étnica y la Mayoría Musulmana</strong></p>
<p>La relación entre la diversidad étnica y la presencia de una mayoría musulmana puede ser compleja y variable.</p>
<ul>
<li><strong>En algunos casos, la diversidad étnica puede verse influenciada por la religión:</strong> En países con mayoría musulmana, la diversidad étnica puede verse afectada por la coexistencia de diferentes grupos religiosos, así como por la integración o exclusión de minorías religiosas.</li>
<li><strong>Conflictos étnicos y religiosos:</strong> En otros casos, la diversidad étnica y la presencia de una mayoría musulmana pueden ser factores de conflicto, especialmente si existe discriminación, polarización política y falta de instituciones inclusivas.</li>
</ul>
<p><strong>El Papel del Envejecimiento Poblacional</strong></p>
<p>El porcentaje de población de 65 años o más, si bien no es el foco principal del análisis, podría tener efectos indirectos en las otras variables. El envejecimiento poblacional puede afectar:</p>
<ul>
<li><strong>Participación política:</strong> Los países con poblaciones más envejecidas pueden tener una participación política diferente, ya que los intereses de los adultos mayores podrían ser distintos a los de otros grupos de edad.</li>
<li><strong>Crecimiento económico y desarrollo social:</strong> El envejecimiento poblacional también puede afectar el crecimiento económico y el desarrollo social, lo que, a su vez, podría influir en la calidad de la democracia.</li>
</ul>
<p><strong>Conclusiones y Limitaciones</strong></p>
<p>El análisis de los datos proporciona una visión preliminar de la compleja interacción entre la democracia, la diversidad étnica, la religión y la demografía.</p>
<ul>
<li><strong>La democracia y la diversidad étnica:</strong> La relación entre estos elementos no es necesariamente lineal, sino que depende del contexto específico de cada país.</li>
<li><strong>Relación entre democracia y mayoría musulmana:</strong> La prueba t sugiere una diferencia significativa, pero se requiere un análisis adicional para comprender la naturaleza de esta relación y los factores subyacentes.</li>
<li><strong>La relación entre diversidad étnica y mayoría musulmana:</strong> Esta relación también es compleja y variable, y puede ser influenciada por factores históricos, políticos y sociales.</li>
<li><strong>El envejecimiento poblacional:</strong> Aunque no es el foco principal, podría tener un impacto indirecto en las otras variables.</li>
</ul>
<p><strong>Limitaciones del análisis:</strong></p>
<ul>
<li><strong>Datos incompletos:</strong> La falta de acceso a los datos de las variables por cada país y la información de los valores medios del índice de democracia para cada grupo (mayoría musulmana) limitan la profundidad del análisis.</li>
<li><strong>Causalidad:</strong> Los resultados no establecen una relación de causalidad directa entre las variables.</li>
<li><strong>Simplificación:</strong> El análisis simplifica la complejidad de las interacciones entre los factores sociales, políticos y demográficos.</li>
<li><strong>Contexto:</strong> No se incluyen las variables de control relevantes que podrían explicar mejor las relaciones observadas.</li>
</ul>
<p><strong>Recomendaciones para futuras investigaciones:</strong></p>
<ul>
<li><strong>Recopilación de datos más completos:</strong> Es fundamental recopilar datos completos para todas las variables en una muestra más amplia de países.</li>
<li><strong>Análisis de regresión:</strong> Usar análisis de regresión para modelar las relaciones entre las variables y controlar el efecto de otras variables relevantes.</li>
<li><strong>Análisis cualitativo:</strong> Complementar el análisis cuantitativo con estudios cualitativos para comprender mejor los procesos y dinámicas subyacentes.</li>
<li><strong>Consideración del contexto:</strong> Analizar el contexto histórico, político y social de cada país para comprender mejor las relaciones observadas.</li>
</ul>
<p>En resumen, este análisis proporciona una base para comprender las complejas relaciones entre la democracia, la diversidad étnica, la religión y la demografía. Una investigación más profunda, basada en datos más completos y un enfoque metodológico más robusto, podría revelar hallazgos significativos para la comprensión de estos importantes fenómenos sociales.</p>
</section>
<section id="simulación" class="level2">
<h2 class="anchored" data-anchor-id="simulación">Simulación</h2>
<p>Otra aplicación de la IA generativa para la investigación consiste en realizar simulaciones. Podemos utilizar la información de entrenamiento para simular expertos y pedir que respondan a preguntas o cuestionarios. Esto resulta útil en dos aspectos centrales. Primero, como forma de sistematizar la información sobre un tema. Segundo, para evaluar la capacidad de los modelos de IA generativa para responder preguntas complejas de forma precisa y coherente.</p>
<p>No exemplo abaixo, utilizamos el modelo Gemini de Google para simular un experto en la República de Weimar. Los modelos LLM suelen ser particularmente buenos cuando se trata de información histórica, puesto que existe una larga literatura sobre el tema y, en algunos casos, parte de esa literatura está disponible en formato digital y en dominio público.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga el paquete</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellmer)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define el modelo</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">"gemini-2.5-flash-preview-04-17"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un objeto chat para</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># acceder al modelo</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>chat <span class="ot">&lt;-</span> <span class="fu">chat_gemini</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">base_url =</span> <span class="st">"https://generativelanguage.googleapis.com/v1beta/"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_args =</span> <span class="fu">list</span>(<span class="at">generationConfig =</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">list</span>(<span class="at">temperature=</span><span class="fl">0.8</span>, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">seed=</span><span class="dv">1234</span>)),  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> model,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="st">"none"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">system_prompt=</span><span class="st">"Actúa como un historiador político experto en el sistema partidario de la República de Weimar. Responde preguntas y proporciona información sobre los partidos políticos de la República de Weimar. Debe ser preciso y objetivo en sus respuestas, evitando opiniones personales o juicios de valor."</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Define la lista de partidos</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>part <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Kommunistische Partei Deutschlands (KPD)"</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sozialdemokratische Partei Deutschlands (SPD)"</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Deutsche Demokratische Partei (DDP)"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Deutsche Volkspartei (DVP)"</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Deutsche Zentrumspartei (Zentrum)"</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Konservative Volkspartei (KVP)"</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nationalsozialistische Deutsche Arbeiterpartei (NSDAP)"</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Deutsche Demokratische Partei (DDP)"</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bayerische Volkspartei (BVP)"</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea el prompt para la evaluación del</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># compromiso democrático de los partidos</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>prompt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Su tarea consiste en evaluar el nivel de compromiso democrático de los partidos políticos que existieron durante dicho periodo, basándote en evidencia histórica sobre su comportamiento parlamentario, su ideología, sus alianzas políticas y su actitud frente a la Constitución de Weimar y nunca para el período posterior.</span><span class="sc">\n\n</span><span class="st">Utiliza la siguiente escala para tu evaluación:</span><span class="sc">\n\n</span><span class="st">0: Completamente antidemocrático (hostil al sistema republicano y parlamentario).</span><span class="sc">\n\n</span><span class="st">10: Completamente democrático (adhesión plena y activa al sistema republicano y parlamentario).</span><span class="sc">\n\n</span><span class="st">N.S.: No se puede determinar con certeza.</span><span class="sc">\n\n</span><span class="st">Responde únicamente con un número del 0 al 10 o con 'N.S.', sin añadir justificaciones ni explicaciones.</span><span class="sc">\n\n</span><span class="st">Partido a evaluar: "</span>, part,<span class="st">"."</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuta el modelo</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>ro <span class="ot">&lt;-</span> chat<span class="sc">$</span><span class="fu">chat</span>(prompt)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Guarda los resultados</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">stri_split_fixed</span>(ro, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">simplify =</span> T))</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea otro prompt para evaluar</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co"># la ideología de los partidos</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>prompt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Su tarea consiste en evaluar la ideología predominante de los partidos políticos en términos de su ubicación en el espectro político de la época, considerando su programa, discursos, acciones políticas, bases sociales y declaraciones oficiales.</span><span class="sc">\n\n</span><span class="st">Utiliza la siguiente escala para tu evaluación ideológica:</span><span class="sc">\n\n</span><span class="st">0: Extrema izquierda</span><span class="sc">\n\n</span><span class="st">10: Extrema derecha</span><span class="sc">\n\n</span><span class="st">N.S.: No se puede determinar con certeza</span><span class="sc">\n\n</span><span class="st">Responde únicamente con un número del 0 al 10 o con 'N.S.', sin añadir justificaciones ni explicaciones.</span><span class="sc">\n\n</span><span class="st"> Partido a evaluar: "</span>, part,<span class="st">"."</span>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuta el modelo</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>ro <span class="ot">&lt;-</span> chat<span class="sc">$</span><span class="fu">chat</span>(prompt)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Guarda los resultados</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">stri_split_fixed</span>(ro, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">simplify =</span> T))</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Organiza todo en un</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="co"># data.frame</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Partido=</span>part, </span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Democracia=</span>ev, </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Ideologia=</span>id)</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza los resultados</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(d1, </span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">sortable=</span>T, </span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">resizable=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-5234e4bab7af0fe15e05" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5234e4bab7af0fe15e05">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Partido":["Kommunistische Partei Deutschlands (KPD)","Sozialdemokratische Partei Deutschlands (SPD)","Deutsche Demokratische Partei (DDP)","Deutsche Volkspartei (DVP)","Deutsche Zentrumspartei (Zentrum)","Konservative Volkspartei (KVP)","Nationalsozialistische Deutsche Arbeiterpartei (NSDAP)","Deutsche Demokratische Partei (DDP)","Bayerische Volkspartei (BVP)"],"Democracia":[0,10,10,7,9,1,0,10,6],"Ideologia":[0,3,4,6,5,8,10,4,7]},"columns":[{"id":"Partido","name":"Partido","type":"character"},{"id":"Democracia","name":"Democracia","type":"numeric"},{"id":"Ideologia","name":"Ideologia","type":"numeric"}],"resizable":true,"dataKey":"295491bbc9ac85a97d4aadd06495bb9f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Rodrigo Rodrigues-Silveira</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://oir.org.es/pela/"><img src="logo_pela.png" class="img-fluid" alt="Posit" width="500"></a></p>
</div>
  </div>
</footer>




</body></html>